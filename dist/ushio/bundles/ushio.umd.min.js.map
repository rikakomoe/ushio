{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://ushio/lib/ushio.service.ts","ng://ushio/lib/ushio.component.ts","ng://ushio/lib/ushio.module.ts"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","__values","o","m","UshioI18nProvider","lang","i18nSource","en","speed","normal","loop","noLoop","fullscreen","exitFullscreen","statistic","language","mute","zh-Hans","_b","tslib_1.__values","navigator","languages","_c","langCode","setLanguage","bind","defineProperty","entries","map","entry","key","UshioService","timeStampRegex","i18n","version","build","parseSubtitles","input","str","_this","origin","trim","replace","split","splitSubtitles","cachedSubtitle","state","forEach","line","match","exec","startTime","endTime","texts","Error","processLine","Injectable","args","providedIn","UshioSource","Directive","selector","Input","UshioSubtitles","UshioComponent","element","zone","changeDetectorRef","sanitization","service","mInjectedStyles","preload","mSources","sources","playingSource","mSubtitles","subtitles","flyingSubtitles","mVolume","volumeChange","EventEmitter","mPlaybackRate","playbackRateChange","mVolumeControl","mSourceControl","mSubtitlesControl","mSettingsControl","mLoopControl","mFullscreenControl","subtitlesSlotUpdate$","Subject","sourcesSlotUpdate$","subtitlesSlotChange$","asObservable","pipe","distinctUntilChanged","sourcesSlotChange$","mobileShowControlStateChange$","showControlProbablyChanged$","showControlChange$","showControl","interactMode","focus","mShowControl","mNoCursor","thumbMouseDown","controlMouseDown","controlHoveredClass","showContextMenu","showStatisticInfoPanel","showVolumeHint","showProgressDetail","showControlChange","mPaused","pausedChange","mCurrentTime","currentTimeChange","duration","durationChange","bufferedTime","waiting","waitingChange","loopChange","mutedChange","fps","fpsStart","fpsIndex","panelTranslations","settings","source","mContextMenuPosition","mProgressDetailPosition","mProgressDetailContainerPosition","mProgressDetailTimePosition","mProgressDetailPositionRate","contextMenuState","subscriptions","mouseSubscriptions","keySubscriptions","mouseMove$","fromEvent","document","mouseUp$","touchMove$","touchStart$","touchEnd$","merge","mouseTouchUp$","showLangMenu","onComponentClicked","onDocumentClicked","style","bypassSecurityTrustHtml","mSrc","src","updateSources","filter","enabled","volume","video","nativeElement","muted","Math","round","playbackRate","volumeControl","setAllControlPanelsPosition","sourceControl","subtitlesControl","settingsControl","loopControl","fullscreenControl","fullscreenElement","mouseDown","enabledSubtitles","isFullScreen","paused","pause","play","currentTime","formatDuration","bypassSecurityTrustStyle","volume100","mapSpeedToProgress","height","videoHeight","videoWidth","thumbnails","ceil","toFixed","mapProgressToSpeed","progress","floor","h","ngOnInit","ngAfterContentInit","mapPropsToObject","props","fn","sourceObj","reduce","agg","cur","_a","onContentChildrenOrSlotChanged$","attr","contentChildren","slotChange$","contentChildrenMap","obj","slotMap","getAttribute","of","toArray","changes","contents","subtitlesChange$","subtitlesContentChildren","sourcesChange$","sourceContentChildren","runOutsideAngular","subscribe","updateSubtitles","detectChanges","onUnfocused","sub","unsubscribe","onFocused","onKeyDown$","code","tap","preventDefault","stopPropagation","togglePlay","showVolumeHint$","switchMap","timer","mapTo","onControlDismiss","controlHoveredChange","onControlShown","ifMouseInArea","btnElement","popUpElement","rect1","getBoundingClientRect","rect2","clientX","left","right","clientY","top","bottom","mouseHoverProgressState$","rect","slider","yCenter","abs","containerLeft","width","timeLeft","a","b","mapToRate","total","moveEvent","eventCoordinate","TouchEvent","changedTouches","onMouseTouchDown$","onMouseTouchDrag$","concatMap","takeUntil","thumbMouseTouchDown$","thumbTouchDrag$","timeUpdate","subscribeTimeUpdate","btns","controlHoverStateChange$","volumeBtn","volumePanel","btnName","settingsBtn","settingsPanel","sourceBtn","sourcePanel","subtitlesBtn","subtitlesPanel","btns_1","btns_1_1","btn","subscribeControlHoveredChange","volumeMouseTouchDown$","volumeBar","volumeTouchDrag$","speedMouseTouchDown$","speedBar","speedTouchDrag$","emit","updateFlyingSubtitles","ngAfterViewInit","desktopShowControlStateChange$","delaySwitch","showControlStateChange$","noCursor","NEVER","timeRanges","end","start","buffered","outer","panel","contextMenu","langContextMenuOption","addEventListener","ngOnDestroy","removeEventListener","shortName","name","default","type","undefined","sm_1","shortname","values","indexOfDefault","findIndex","parsedSubtitles","text","fetch","_d","parsed","class","srclang","toLowerCase","console","warn","error","flyingSubtitlesTrack","subtitle","setTimeout","loopBtn","loopPanel","fullScreenBtn","fullScreenPanel","item","setPanelPosition","outerRect","panelRect","btnRect","onSlotChange","target","assignedNodes","node","nodeName","innerHTML","onVideoMaskClicked","onSelectSource","load","onCheckSubtitles","toggleMute","random","toggleLoop","toggleFullscreen","requestFullscreen","toggleShowStatisticInfoPanel","animationFrame$","animationFrameScheduler","repeat","animationFrame","Date","fpsCurrent","Component","template","encapsulation","ViewEncapsulation","ShadowDom","ElementRef","NgZone","ChangeDetectorRef","DomSanitizer","Output","ViewChild","static","ContentChildren","UshioModule","NgModule","declarations","imports","CommonModule","exports"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { Injectable } from '@angular/core'\n\nexport interface ISubtitle {\n  startTime: number\n  endTime: number\n  texts: string[]\n}\n\nclass UshioI18nProvider {\n  private lang = 'en'\n  private readonly i18nSource = {\n    en: {\n      lang: 'English',\n      speed: 'Speed',\n      normal: 'Normal',\n      loop: 'Loop',\n      noLoop: 'No Loop',\n      fullscreen: 'Fullscreen',\n      exitFullscreen: 'Exit fullscreen',\n      statistic: 'Video statistic',\n      language: 'Language',\n      mute: 'Mute'\n    },\n    'zh-Hans': {\n      lang: 'ç®ä½ä¸­æ',\n      speed: 'æ­æ¾éåº¦',\n      normal: 'æ­£å¸¸',\n      loop: 'å¾ªç¯æ­æ¾',\n      noLoop: 'å³é­å¾ªç¯',\n      fullscreen: 'å¨å±æ­æ¾',\n      exitFullscreen: 'éåºå¨å±',\n      statistic: 'è§é¢ç»è®¡ä¿¡æ¯',\n      language: 'è¯­è¨',\n      mute: 'éé³'\n    }\n  }\n  get languages () {\n    return Object.entries(this.i18nSource).map(entry => [entry[0], entry[1].lang])\n  }\n  get language () {\n    return this.lang\n  }\n\n  constructor () {\n    for (const langCode of navigator.languages) {\n      if (this.setLanguage(langCode)) break\n    }\n    this.t = this.t.bind(this)\n  }\n\n  setLanguage (langCode): boolean {\n    if (this.i18nSource[langCode]) {\n      this.lang = langCode\n      return true\n    }\n    return false\n  }\n\n  t (key: string): string {\n    return this.i18nSource[this.lang][key]\n  }\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UshioService {\n\n  static version = '4.0.0'\n  static build = 'NG Build'\n\n  // tslint:disable-next-line:max-line-length\n  private readonly timeStampRegex = /^(?:(\\d{2,})(:))?([0-5][0-9])(:)([0-5][0-9])([,.])(\\d{3})( --> )(?:(\\d{2,})(:))?([0-5][0-9])(:)([0-5][0-9])([,.])(\\d{3})/\n  i18n = new UshioI18nProvider()\n  get version () {\n    return UshioService.version\n  }\n  get build () {\n    return UshioService.build\n  }\n\n  constructor () { }\n\n  parseSubtitles (input: string): ISubtitle[] {\n    const trim = (str: string) => str.trim()\n      .replace(/^[^\\S\\n]+/gm, '')\n      .replace(/\\u0000/g, '\\uFFFD')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\r/g, '\\n')\n      .replace(/\\n{3,}/g, '\\n\\n')\n    const origin = trim(input)\n      .split('\\n')\n    const splitSubtitles: ISubtitle[] = []\n    let cachedSubtitle: ISubtitle | null = null\n    let state = 'root'\n    const processLine = (line: string) => {\n      switch (state) {\n        case 'note':\n        /* falls through */\n        case 'title':\n          if (line === '') {\n            state = 'root'\n          }\n          return\n        case 'root':\n          if (line.match(/^WEBVTT/)) {\n            state = 'title'\n            return\n          } else if (line.match(/^NOTE/)) {\n            state = 'note'\n            return\n          } else if (line === '') return [line]\n          else if (!line.match(/-->/)) {\n            state = 'timeline'\n            return\n          }\n        /* falls through */\n        case 'timeline':\n          const match = this.timeStampRegex.exec(line)\n          if (match) {\n            cachedSubtitle = {\n              startTime: 1000 * (60 * (60 * +match[1] + +match[3]) + +match[5]) + +match[7] || 0,\n              endTime: 1000 * (60 * (60 * +match[9] + +match[11]) + +match[13]) + +match[15] || 0,\n              texts: []\n            }\n            state = 'text'\n            return\n          } else {\n            throw new Error(`unexpected timeline token: ${line}`)\n          }\n        case 'text':\n          if (line === '') {\n            state = 'root'\n            if (cachedSubtitle) {\n              splitSubtitles.push(cachedSubtitle)\n              cachedSubtitle = null\n            }\n          } else if (cachedSubtitle) {\n            cachedSubtitle.texts.push(line)\n          }\n      }\n    }\n    origin.forEach(line => processLine(line))\n    if (cachedSubtitle) splitSubtitles.push(cachedSubtitle)\n    return splitSubtitles\n  }\n\n}\n","import {\n  AfterContentInit,\n  AfterViewInit, ChangeDetectorRef,\n  Component,\n  ContentChildren,\n  Directive,\n  ElementRef, EventEmitter,\n  Input, NgZone,\n  OnDestroy,\n  OnInit, Output,\n  QueryList,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core'\nimport { DomSanitizer, SafeStyle } from '@angular/platform-browser'\nimport {\n  animationFrameScheduler,\n  fromEvent, merge, NEVER, Observable, of,\n  Subject, Subscription, timer\n} from 'rxjs'\nimport {\n  concatMap, distinctUntilChanged,\n  filter, map, mapTo, repeat, switchMap, takeUntil, tap\n} from 'rxjs/operators'\n\nimport { ISubtitle, UshioService } from './ushio.service'\n\n@Directive({\n  // tslint:disable-next-line:directive-selector\n  selector: 'ushio-source'\n})\nexport class UshioSource {\n  @Input() src!: string\n  @Input() type: string\n  @Input() shortname: string\n  @Input() name: string\n  @Input() default: boolean\n}\n\n@Directive({\n  // tslint:disable-next-line:directive-selector\n  selector: 'ushio-subtitles'\n})\nexport class UshioSubtitles {\n  @Input() value: string\n  @Input() src: string\n  @Input() type: string\n  @Input() name: string\n  @Input() class: string\n  @Input() srclang: string\n  @Input() default: boolean\n}\n\ninterface Source {\n  shortName: string\n  name: string\n  sources: {\n    src: string;\n    type: string;\n  }[]\n  default?: boolean\n}\n\ninterface Subtitles {\n  name: string\n  class: string\n  parsedSubtitles: ISubtitle[]\n  enabled: boolean\n}\n\n@Component({\n  selector: 'ushio-player',\n  templateUrl: './ushio.component.html',\n  styleUrls: ['./ushio.component.styl'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class UshioComponent implements OnInit, AfterContentInit, AfterViewInit, OnDestroy {\n\n  private mInjectedStyles = []\n  get injectedStyles () {\n    return this.mInjectedStyles.map(\n      style => this.sanitization.bypassSecurityTrustHtml(`\n      <style>\n       ${style}\n      </style>\n    `))\n  }\n\n  @Input() set src (src) {\n    this.mSrc = src\n    this.updateSources()\n  }\n  get src () {\n    return this.mSrc\n  }\n  @Input() poster\n  @Input() crossorigin\n  @Input() autoplay\n  @Input() preload = 'metadata'\n  @Input() set lang (lang: string) {\n    this.service.i18n.setLanguage(lang)\n  }\n  @Input() thumbnails\n\n  private mSrc\n  private mSources = []\n  sources: Source[] = []\n  playingSource = 0\n\n  private mSubtitles = []\n  subtitles: Subtitles[] = []\n  get enabledSubtitles () {\n    return this.subtitles.filter(s => s.enabled)\n  }\n  flyingSubtitles: Subtitles[] = []\n\n  private mVolume = 1\n  @Input() set volume (volume) {\n    this.video.nativeElement.volume = volume\n  }\n  get volume100 () {\n    if (this.video.nativeElement.muted) return 0\n    return Math.round(this.mVolume * 100)\n  }\n  @Output() volumeChange = new EventEmitter<number>()\n\n  private mPlaybackRate = 1\n  @Input() set playbackRate (playbackRate) {\n    this.video.nativeElement.playbackRate = playbackRate\n  }\n  @Output() playbackRateChange = new EventEmitter<number>()\n\n  private mVolumeControl = true\n  @Input() set volumeControl (volumeControl) {\n    this.mVolumeControl = volumeControl\n    this.setAllControlPanelsPosition()\n  }\n  get volumeControl () {\n    return this.mVolumeControl\n  }\n  private mSourceControl = true\n  @Input() set sourceControl (sourceControl) {\n    this.mSourceControl = sourceControl\n    this.setAllControlPanelsPosition()\n  }\n  get sourceControl () {\n    return this.mSourceControl\n  }\n  private mSubtitlesControl = true\n  @Input() set subtitlesControl (subtitlesControl) {\n    this.mSubtitlesControl = subtitlesControl\n    this.setAllControlPanelsPosition()\n  }\n  get subtitlesControl () {\n    return this.mSubtitlesControl\n  }\n  private mSettingsControl = true\n  @Input() set settingsControl (settingsControl) {\n    this.mSettingsControl = settingsControl\n    this.setAllControlPanelsPosition()\n  }\n  get settingsControl () {\n    return this.mSettingsControl\n  }\n  private mLoopControl = true\n  @Input() set loopControl (loopControl) {\n    this.mLoopControl = loopControl\n    this.setAllControlPanelsPosition()\n  }\n  get loopControl () {\n    return this.mLoopControl\n  }\n  private mFullscreenControl = true\n  @Input() set fullscreenControl (fullscreenControl) {\n    this.mFullscreenControl = fullscreenControl\n    this.setAllControlPanelsPosition()\n  }\n  get fullscreenControl () {\n    return this.mFullscreenControl\n  }\n\n  @ViewChild('video', { static: true }) video\n  @ViewChild('slider', { static: true }) slider\n  @ViewChild('volumeBar', { static: true }) volumeBar\n  @ViewChild('volumePanel', { static: true }) volumePanel\n  @ViewChild('volumeBtn', { static: true }) volumeBtn\n  @ViewChild('settingsPanel', { static: true }) settingsPanel\n  @ViewChild('settingsBtn', { static: true }) settingsBtn\n  @ViewChild('speedBar', { static: true }) speedBar\n  @ViewChild('sourcePanel', { static: true }) sourcePanel\n  @ViewChild('sourceBtn', { static: true }) sourceBtn\n  @ViewChild('subtitlesPanel', { static: true }) subtitlesPanel\n  @ViewChild('subtitlesBtn', { static: true }) subtitlesBtn\n  @ViewChild('loopBtn', { static: true }) loopBtn\n  @ViewChild('loopPanel', { static: true }) loopPanel\n  @ViewChild('fullScreenBtn', { static: true }) fullScreenBtn\n  @ViewChild('fullScreenPanel', { static: true }) fullScreenPanel\n  @ViewChild('contextMenu', { static: true }) contextMenu\n  @ViewChild('langContextMenuOption', { static: true }) langContextMenuOption\n\n  @ContentChildren(UshioSource) sourceContentChildren!: QueryList<UshioSource>\n  @ContentChildren(UshioSubtitles) subtitlesContentChildren!: QueryList<UshioSubtitles>\n  private subtitlesSlotUpdate$ = new Subject<HTMLElement[]>()\n  private sourcesSlotUpdate$ = new Subject<HTMLElement[]>()\n  private subtitlesSlotChange$ = this.subtitlesSlotUpdate$.asObservable().pipe(distinctUntilChanged())\n  private sourcesSlotChange$ = this.sourcesSlotUpdate$.asObservable().pipe(distinctUntilChanged())\n  private mobileShowControlStateChange$ = new Subject<{ showControl: boolean, delaySwitch: boolean }>()\n  private showControlProbablyChanged$ = new Subject()\n  private showControlChange$ = this.showControlProbablyChanged$.asObservable().pipe(\n    map(() => this.showControl),\n    distinctUntilChanged()\n  )\n\n  interactMode: 'desktop' | 'mobile' = 'desktop'\n  private focus = false\n  private mShowControl = false\n  private mNoCursor = false\n  private thumbMouseDown = false\n  private controlMouseDown = false\n  controlHoveredClass = ''\n  private showContextMenu = false\n  private showStatisticInfoPanel = false\n  private showVolumeHint = false\n  private showProgressDetail = false\n  get isFullScreen (): boolean {\n    return document.fullscreenElement !== null\n  }\n  get mouseDown (): boolean {\n    return this.thumbMouseDown || this.controlMouseDown\n  }\n  get showControl () {\n    return !!(this.mShowControl || this.mouseDown)\n  }\n  get noCursor () {\n    return !this.showControl && this.mNoCursor\n  }\n  @Output() showControlChange = new EventEmitter<boolean>()\n  get thumbMouseDownClass (): string {\n    return this.thumbMouseDown ? ' thumb-mouse-down' : ''\n  }\n  get pausedClass (): string {\n    return this.mPaused ? ' video-state-pause' : ' video-state-play'\n  }\n  get waitingClass (): string {\n    return this.waiting && !this.mPaused ? ' video-state-waiting' : ''\n  }\n  get mutedClass (): string {\n    return (this.video.nativeElement.muted || this.video.nativeElement.volume === 0)\n      ? ' video-state-muted' : ' video-state-volume'\n  }\n  get loopClass (): string {\n    return this.video.nativeElement.loop ? ' video-state-loop' : ' video-state-noloop'\n  }\n  get subtitleEnabledClass (): string {\n    return this.enabledSubtitles.length > 0 ? ' video-state-subtitles' : ' video-state-nosubtitles'\n  }\n  get fullscreenClass (): string {\n    return this.isFullScreen ? ' video-state-fullscreen' : ' video-state-nofullscreen'\n  }\n  get contextMenuClass (): string {\n    return this.contextMenuState + (this.showContextMenu ? ' active' : '')\n  }\n  get statisticInfoPanelClass (): string {\n    return this.showStatisticInfoPanel ? ' active' : ''\n  }\n  get volumeHintClass (): string {\n    return this.showVolumeHint ? ' active' : ''\n  }\n  get progressDetailClass (): string {\n    return this.showProgressDetail ? ' active' : ''\n  }\n\n  private mPaused = true\n  @Input() set paused (paused) {\n    if (paused) this.video.nativeElement.pause()\n    else this.video.nativeElement.play()\n  }\n  @Output() pausedChange = new EventEmitter<boolean>()\n  private mCurrentTime = 0\n  @Input() set currentTime (currentTime) {\n    this.video.nativeElement.currentTime = currentTime\n  }\n  @Output() currentTimeChange = new EventEmitter<number>()\n  private duration = 0\n  @Output() durationChange = new EventEmitter<number>()\n  private bufferedTime = 0\n  private waiting = false\n  @Output() waitingChange = new EventEmitter<boolean>()\n  @Input() set loop (loop) {\n    this.video.nativeElement.loop = loop\n  }\n  @Output() loopChange = new EventEmitter<boolean>()\n  @Input() set muted (muted) {\n    this.video.nativeElement.muted = muted\n  }\n  @Output() mutedChange = new EventEmitter<boolean>()\n\n  fps = '0.00'\n  private fpsStart = 0\n  private fpsIndex = 0\n\n  get currentTimeStr (): string {\n    return UshioComponent.formatDuration(this.mCurrentTime)\n  }\n  get durationStr (): string {\n    return UshioComponent.formatDuration(this.duration)\n  }\n  get bufferedProgress (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: scaleX(${this.bufferedTime / this.duration})`\n    )\n  }\n  get playedProgress (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: scaleX(${this.mCurrentTime / this.duration})`\n    )\n  }\n  get thumbPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `left: ${this.mCurrentTime / this.duration * 100}%`\n    )\n  }\n  get volumeRate (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: scaleY(${this.volume100 / 100})`\n    )\n  }\n  get volumeThumbPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `bottom: ${this.volume100}%`\n    )\n  }\n  get speedThumbPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `left: ${UshioComponent.mapSpeedToProgress(this.mPlaybackRate)}%`\n    )\n  }\n  private panelTranslations = {\n    settings: 0,\n    source: 0,\n    subtitles: 0,\n    loop: 0,\n    fullscreen: 0\n  }\n  get settingsPanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.settings}px - 50%))`\n    )\n  }\n  get sourcePanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.source}px - 50%))`\n    )\n  }\n  get subtitlesPanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.subtitles}px - 50%))`\n    )\n  }\n  get loopPanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.loop}px - 50%))`\n    )\n  }\n  get fullScreenPanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.fullscreen}px - 50%))`\n    )\n  }\n  private mContextMenuPosition = ''\n  get contextMenuPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(this.mContextMenuPosition)\n  }\n  private mProgressDetailPosition = ''\n  private mProgressDetailContainerPosition = ''\n  private mProgressDetailTimePosition = ''\n  private mProgressDetailPositionRate = 0\n  get progressDetailPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(this.mProgressDetailPosition)\n  }\n  get progressDetailContainerPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(this.mProgressDetailContainerPosition)\n  }\n  get progressDetailTimePosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(this.mProgressDetailTimePosition)\n  }\n  get progressDetailImgStyle (): SafeStyle {\n    const height = this.video.nativeElement.videoHeight * 160 / this.video.nativeElement.videoWidth\n    return this.sanitization.bypassSecurityTrustStyle(\n      `height: ${height}px;\n       line-height: ${height}px;\n       background-image: url(\"${this.thumbnails}\");\n       background-position: -${(Math.ceil(this.mProgressDetailPositionRate * 100) - 1) * 160}px 0;`\n    )\n  }\n  get progressDetailTime (): string {\n    return UshioComponent.formatDuration(this.mProgressDetailPositionRate * this.duration)\n  }\n\n  languages = this.service.i18n.languages\n  contextMenuState = 'root'\n  get version () {\n    return this.service.version\n  }\n  get detailedVersion () {\n    return `v${this.service.version} (${this.service.build})`\n  }\n  get videoResolution () {\n    return `${this.video.nativeElement.videoWidth} x ${this.video.nativeElement.videoHeight}`\n  }\n  get videoDuration () {\n    return this.video.nativeElement.duration.toFixed(6)\n  }\n  get videoCurrentTime () {\n    return this.video.nativeElement.currentTime.toFixed(6)\n  }\n\n  private timeUpdate: Subscription\n  private controlHoveredChange: Subscription\n  private animationFrame: Subscription\n  private subscriptions: Subscription[] = []\n  private mouseSubscriptions: Subscription[] = []\n  private keySubscriptions: Subscription[] = []\n  private mouseMove$ = fromEvent(document, 'mousemove')\n  private mouseUp$ = fromEvent(document, 'mouseup')\n  private touchMove$ = fromEvent(document, 'touchmove')\n  private touchStart$ = fromEvent(document, 'touchstart')\n  private touchEnd$ = merge(\n    fromEvent(document, 'touchend'),\n    fromEvent(document, 'touchcancel')\n  )\n  private mouseTouchUp$ = merge(this.mouseUp$, this.touchEnd$)\n\n  t = this.service.i18n.t\n\n  static mapSpeedToProgress (speed) {\n    if (speed < .5) return 0\n    else if (speed < 1.5) return (speed - .5) * 80\n    else if (speed < 2.0) return 80 + (speed - 1.5) * 40\n    else return 100\n  }\n  static mapProgressToSpeed (progress) {\n    if (progress < .1) return .5\n    else if (progress < .9) return .75 + .25 * Math.floor((progress - 0.1) * 5)\n    else return 2\n  }\n\n  static formatDuration (duration: number) {\n    const h = Math.floor(duration / 3600)\n    const m = Math.floor(duration % 3600 / 60)\n    const s = Math.floor(duration % 60)\n    let str = ''\n    if (h && h < 10) { str += `0${h}:` } else if (h) { str += `${h}:` }\n    if (m < 10) { str += `0${m}:` } else { str += `${m}:` }\n    if (s < 10) { str += `0${s}` } else { str += `${s}` }\n    return str\n  }\n\n  constructor (\n    private element: ElementRef,\n    private zone: NgZone,\n    private changeDetectorRef: ChangeDetectorRef,\n    private sanitization: DomSanitizer,\n    private service: UshioService\n  ) {\n    this.showLangMenu = this.showLangMenu.bind(this)\n    this.onComponentClicked = this.onComponentClicked.bind(this)\n    this.onDocumentClicked = this.onDocumentClicked.bind(this)\n  }\n\n  ngOnInit () {\n    this.mPaused = this.video.nativeElement.paused\n    this.mVolume = this.video.nativeElement.volume\n    this.mPlaybackRate = this.video.nativeElement.playbackRate\n  }\n\n  ngAfterContentInit () {\n    const mapPropsToObject = (props: string[], fn) => (sourceObj: any) => (\n      props.reduce((agg, cur) => ({ ...agg, [cur]: fn(sourceObj, cur) }), {})\n    )\n    const onContentChildrenOrSlotChanged$ = (\n      attr, contentChildren:\n      QueryList<any>,\n      slotChange$: Observable<HTMLElement[]>\n    ) => {\n      const contentChildrenMap = mapPropsToObject(attr, (obj, cur) => (obj[cur]))\n      const slotMap = mapPropsToObject(attr, (obj, cur) => (obj.getAttribute(cur)))\n      return merge(\n        of(contentChildren.toArray().map(contentChildrenMap)),\n        contentChildren.changes.pipe(\n          map((contents: QueryList<any>) => (contents.toArray().map(contentChildrenMap)))\n        ),\n        slotChange$.pipe(\n          map((contents: HTMLElement[]) => (\n            contents.map(slotMap)\n          ))\n        )\n      )\n    }\n    const subtitlesAttr = ['value', 'type', 'src', 'name', 'class', 'default', 'srclang']\n    const subtitlesChange$ = onContentChildrenOrSlotChanged$(\n      subtitlesAttr, this.subtitlesContentChildren, this.subtitlesSlotChange$)\n    const sourcesAttr = ['src', 'type', 'name', 'shortname', 'default']\n    const sourcesChange$ = onContentChildrenOrSlotChanged$(\n      sourcesAttr, this.sourceContentChildren, this.sourcesSlotChange$)\n    this.zone.runOutsideAngular(() => {\n      this.subscriptions.push(subtitlesChange$.subscribe(async (subtitles) => {\n        this.mSubtitles = subtitles\n        await this.updateSubtitles()\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.subscriptions.push(sourcesChange$.subscribe((sources) => {\n        this.mSources = sources\n        this.updateSources()\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n  }\n\n  onUnfocused () {\n    this.keySubscriptions.forEach(sub => sub.unsubscribe())\n    this.keySubscriptions = []\n  }\n\n  onFocused () {\n    const onKeyDown$ = code => fromEvent(document, 'keydown').pipe(\n      filter((e: KeyboardEvent) => this.focus && e.code === code),\n      tap(e => {\n        e.preventDefault()\n        e.stopPropagation()\n      })\n    )\n    this.zone.runOutsideAngular(() => {\n      this.keySubscriptions.push(onKeyDown$('Space').subscribe(e => {\n        this.togglePlay()\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.keySubscriptions.push(onKeyDown$('ArrowRight').subscribe(() => {\n        this.mCurrentTime = this.mCurrentTime + 5 < this.duration ? this.mCurrentTime + 5 : this.duration\n        this.video.nativeElement.currentTime = this.mCurrentTime\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.keySubscriptions.push(onKeyDown$('ArrowLeft').subscribe(() => {\n        this.mCurrentTime = this.mCurrentTime - 5 > 0 ? this.mCurrentTime - 5 : 0\n        this.video.nativeElement.currentTime = this.mCurrentTime\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.keySubscriptions.push(onKeyDown$('ArrowUp').subscribe(() => {\n        this.mVolume = this.mVolume + 0.1 < 0.999996 ? this.mVolume + 0.1 : 1\n        this.video.nativeElement.volume = this.mVolume\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.keySubscriptions.push(onKeyDown$('ArrowDown').subscribe(() => {\n        this.mVolume = this.mVolume - 0.1 > 0.000004 ? this.mVolume - 0.1 : 0\n        this.video.nativeElement.volume = this.mVolume\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n    const showVolumeHint$ = merge(onKeyDown$('ArrowUp'), onKeyDown$('ArrowDown'))\n      .pipe(\n        switchMap(\n          () => merge(of(true), timer(1000).pipe(mapTo(false)))\n        ),\n        distinctUntilChanged()\n      )\n    this.zone.runOutsideAngular(() => {\n      this.keySubscriptions.push(showVolumeHint$.subscribe(e => {\n        this.showVolumeHint = e\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.setAllControlPanelsPosition()\n    })\n  }\n\n  onControlDismiss () {\n    this.mouseSubscriptions.forEach(sub => sub.unsubscribe())\n    this.mouseSubscriptions = []\n    if (this.controlHoveredChange) {\n      this.controlHoveredChange.unsubscribe()\n      this.controlHoveredChange = null\n    }\n  }\n\n  onControlShown () {\n    const ifMouseInArea = (e: MouseEvent, btnElement, popUpElement) => {\n      const rect1 = popUpElement.getBoundingClientRect()\n      const rect2 = btnElement.getBoundingClientRect()\n      return (e.clientX > rect1.left &&\n        e.clientX < rect1.right &&\n        e.clientY > rect1.top &&\n        e.clientY < rect1.bottom) || (e.clientX > rect2.left &&\n        e.clientX < rect2.right &&\n        e.clientY > rect2.top &&\n        e.clientY < rect2.bottom)\n    }\n    const onControlBtnHoverStateChanged$ = (btns) => {\n      return this.mouseMove$.pipe(\n        switchMap((e: MouseEvent) => {\n          for (const btn of btns) {\n            if (ifMouseInArea(e, btn.btnElement, btn.popUpElement)) {\n              return of(` btn-${btn.btnName}-hover`)\n            }\n          }\n          return timer(150).pipe(\n            mapTo('')\n          )\n        }),\n        distinctUntilChanged()\n      )\n    }\n    const mouseHoverProgressState$ = this.mouseMove$.pipe(\n      filter(() => (this.interactMode === 'desktop')),\n      map((e: MouseEvent) => {\n        const rect = this.slider.nativeElement.getBoundingClientRect()\n        const yCenter = (rect.top + rect.bottom) / 2\n        if (Math.abs(e.clientY - yCenter) < 8 && e.clientX > rect.left && e.clientX < rect.right) {\n          const left = e.clientX - rect.left\n          const containerLeft = left < 80 ? 90 - left : left > rect.width - 80 ? rect.width - left - 70 : 10\n          const timeLeft = left < 20 ? 30 - left : left > rect.width - 20 ? rect.width - left - 10 : 10\n          return { left, containerLeft, timeLeft, width: rect.width }\n        } else {\n          return false\n        }\n      }),\n      distinctUntilChanged((a, b) => {\n        if (typeof a !== typeof b) {\n          return false\n        } else if (typeof a === 'object' && typeof b === 'object') {\n          return a.left === b.left && a.containerLeft === b.containerLeft\n            && a.timeLeft === b.timeLeft && a.width === b.width\n        } else {\n          return a === b\n        }\n      })\n    )\n    this.zone.runOutsideAngular(() => {\n      this.mouseSubscriptions.push(mouseHoverProgressState$.subscribe(state => {\n        if (typeof state === 'boolean') {\n          this.showProgressDetail = state\n        } else {\n          this.showProgressDetail = true\n          this.mProgressDetailPosition = `left: ${state.left}px`\n          this.mProgressDetailContainerPosition = `left: ${state.containerLeft}px`\n          this.mProgressDetailTimePosition = `left: ${state.timeLeft}px`\n          this.mProgressDetailPositionRate = state.left / state.width\n        }\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n    const mapToRate = (element, progress, total) => map(\n      (moveEvent: MouseEvent | TouchEvent) => {\n        const eventCoordinate = moveEvent instanceof TouchEvent\n          ? moveEvent.changedTouches[0]\n          : moveEvent\n        const rect = element.getBoundingClientRect()\n        let p = progress(eventCoordinate, rect)\n        const t = total(rect)\n        if (p < 0) p = 0\n        else if (p > t) p = t\n        return p / t\n      }\n    )\n    const onMouseTouchDown$ = (element, progress, total) => {\n      return merge(\n        fromEvent(element, 'mousedown'),\n        fromEvent(element, 'touchstart')\n      ).pipe(\n        mapToRate(element, progress, total)\n      )\n    }\n    const onMouseTouchDrag$ = (element, progress, total) => {\n      return merge(\n        fromEvent(element, 'mousedown').pipe(\n          mapToRate(element, progress, total),\n          concatMap(() => {\n            return this.mouseMove$.pipe(\n              takeUntil(this.mouseUp$),\n              mapToRate(element, progress, total)\n            )\n          })\n        ),\n        fromEvent(element, 'touchstart').pipe(\n          mapToRate(element, progress, total),\n          concatMap(() => {\n            return this.touchMove$.pipe(\n              takeUntil(this.touchEnd$),\n              mapToRate(element, progress, total)\n            )\n          })\n        )\n      )\n    }\n    const thumbMouseTouchDown$ = onMouseTouchDown$(\n      this.slider.nativeElement,\n      (moveEvent, rect) => (moveEvent.clientX - rect.left),\n      (rect) => (rect.width)\n    )\n    const thumbTouchDrag$ = onMouseTouchDrag$(\n      this.slider.nativeElement,\n      (moveEvent, rect) => (moveEvent.clientX - rect.left),\n      (rect) => (rect.width)\n    )\n    this.zone.runOutsideAngular(() => {\n      this.mouseSubscriptions.push(thumbMouseTouchDown$.subscribe(e => {\n        this.thumbMouseDown = true\n        this.timeUpdate.unsubscribe()\n        this.mCurrentTime = e * this.duration\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(thumbTouchDrag$.subscribe(e => {\n        this.mCurrentTime = e * this.duration\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(this.mouseTouchUp$.subscribe(() => {\n        if (this.thumbMouseDown) {\n          this.video.nativeElement.currentTime = this.mCurrentTime\n          this.subscribeTimeUpdate()\n          this.thumbMouseDown = false\n          this.showControlProbablyChanged$.next(0)\n          this.changeDetectorRef.detectChanges()\n        }\n      }))\n    })\n    const controlHoverStateChange$ = onControlBtnHoverStateChanged$([{\n      btnElement: this.volumeBtn.nativeElement,\n      popUpElement: this.volumePanel.nativeElement,\n      btnName: 'volume'\n    }, {\n      btnElement: this.settingsBtn.nativeElement,\n      popUpElement: this.settingsPanel.nativeElement,\n      btnName: 'settings'\n    }, {\n      btnElement: this.sourceBtn.nativeElement,\n      popUpElement: this.sourcePanel.nativeElement,\n      btnName: 'source'\n    }, {\n      btnElement: this.subtitlesBtn.nativeElement,\n      popUpElement: this.subtitlesPanel.nativeElement,\n      btnName: 'subtitles'\n    }])\n    const subscribeControlHoveredChange = () => {\n      this.zone.runOutsideAngular(() => {\n        this.controlHoveredChange = controlHoverStateChange$.subscribe(e => {\n          this.controlHoveredClass = e\n          this.setAllControlPanelsPosition()\n          this.changeDetectorRef.detectChanges()\n        })\n      })\n    }\n    subscribeControlHoveredChange()\n    const volumeMouseTouchDown$ = onMouseTouchDown$(\n      this.volumeBar.nativeElement,\n      (moveEvent, rect) => (rect.bottom - moveEvent.clientY),\n      (rect) => (rect.height)\n    )\n    const volumeTouchDrag$ = onMouseTouchDrag$(\n      this.volumeBar.nativeElement,\n      (moveEvent, rect) => (rect.bottom - moveEvent.clientY),\n      (rect) => (rect.height)\n    )\n    this.zone.runOutsideAngular(() => {\n      this.mouseSubscriptions.push(volumeMouseTouchDown$.subscribe(e => {\n        if (!this.controlMouseDown) {\n          this.controlMouseDown = true\n          this.controlHoveredChange.unsubscribe()\n        }\n        this.video.nativeElement.muted = false\n        this.video.nativeElement.volume = e\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(volumeTouchDrag$.subscribe(e => {\n        this.video.nativeElement.volume = e\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(this.mouseTouchUp$.subscribe(() => {\n        if (this.controlMouseDown) {\n          subscribeControlHoveredChange()\n          this.controlMouseDown = false\n          this.showControlProbablyChanged$.next(0)\n          this.changeDetectorRef.detectChanges()\n        }\n      }))\n    })\n    const speedMouseTouchDown$ = onMouseTouchDown$(\n      this.speedBar.nativeElement,\n      (moveEvent, rect) => (moveEvent.clientX - rect.left),\n      (rect) => (rect.width)\n    )\n    const speedTouchDrag$ = onMouseTouchDrag$(\n      this.speedBar.nativeElement,\n      (moveEvent, rect) => (moveEvent.clientX - rect.left),\n      (rect) => (rect.width)\n    )\n    this.zone.runOutsideAngular(() => {\n      this.mouseSubscriptions.push(speedMouseTouchDown$.subscribe(e => {\n        if (!this.controlMouseDown) {\n          this.controlMouseDown = true\n          this.controlHoveredChange.unsubscribe()\n        }\n        this.video.nativeElement.playbackRate = UshioComponent.mapProgressToSpeed(e)\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(speedTouchDrag$.subscribe(e => {\n        this.video.nativeElement.playbackRate = UshioComponent.mapProgressToSpeed(e)\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n  }\n\n  private subscribeTimeUpdate () {\n    this.zone.runOutsideAngular(() => {\n      this.timeUpdate = fromEvent(this.video.nativeElement, 'timeupdate')\n        .subscribe(() => {\n          this.mCurrentTime = this.video.nativeElement.currentTime\n          this.currentTimeChange.emit(this.mCurrentTime)\n          this.updateFlyingSubtitles(this.mCurrentTime)\n          this.changeDetectorRef.detectChanges()\n        })\n    })\n  }\n\n  ngAfterViewInit () {\n    this.touchStart$.subscribe(() => {\n      this.interactMode = 'mobile'\n    })\n    const desktopShowControlStateChange$ = this.mouseMove$.pipe(\n      filter(() => (this.interactMode === 'desktop')),\n      map((e: MouseEvent) => {\n        const rect = this.video.nativeElement.getBoundingClientRect()\n        return {\n          showControl: e.clientX > rect.left &&\n            e.clientX < rect.right &&\n            e.clientY > rect.top &&\n            e.clientY < rect.bottom,\n          delaySwitch: e.clientY < rect.bottom - 46\n        }\n      })\n    )\n    const showControlStateChange$ = merge(\n      desktopShowControlStateChange$,\n      this.mobileShowControlStateChange$\n    ).pipe(\n      switchMap(e => {\n        return e.showControl\n          ? merge(\n            of({\n              showControl: true,\n              noCursor: false\n            }),\n            e.delaySwitch ? timer(\n              this.interactMode === 'desktop' ? 750 : 5000\n            ).pipe(\n              mapTo({\n                showControl: false,\n                noCursor: true\n              })\n            ) : NEVER\n          )\n          : of({\n            showControl: false,\n            noCursor: false\n          })\n      }),\n      distinctUntilChanged((a, b) => (\n        a.showControl === b.showControl && a.noCursor === b.noCursor\n      ))\n    )\n    this.zone.runOutsideAngular(() => {\n      this.subscriptions.push(showControlStateChange$.subscribe(state => {\n        this.mShowControl = state.showControl\n        this.showControlProbablyChanged$.next(0)\n        this.mNoCursor = state.noCursor\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n    if (this.mPaused) this.video.nativeElement.pause()\n    else this.video.nativeElement.play()\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'pause')\n      .subscribe(() => {\n        this.mPaused = true\n        this.pausedChange.emit(true)\n      }))\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'play')\n      .subscribe(() => {\n        this.mPaused = false\n        this.pausedChange.emit(false)\n      }))\n    this.subscribeTimeUpdate()\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'waiting')\n      .subscribe(() => {\n        this.waiting = true\n        this.waitingChange.emit(this.waiting)\n      }))\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'playing')\n      .subscribe(() => {\n        this.waiting = false\n        this.waitingChange.emit(this.waiting)\n      }))\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'progress')\n      .subscribe(() => {\n        this.bufferedTime = ((timeRanges, currentTime) => {\n          const length = timeRanges.length\n          for (let i = 0; i < length; i++) {\n            if (timeRanges.end(i) <= currentTime) {\n              continue\n            }\n            if (timeRanges.start(i) <= currentTime) {\n              return timeRanges.end(i)\n            }\n            return currentTime\n          }\n          return currentTime\n        })(this.video.nativeElement.buffered, this.video.nativeElement.currentTime)\n      }))\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'loadedmetadata')\n      .subscribe(() => {\n        this.duration = this.video.nativeElement.duration\n        this.durationChange.emit(this.duration)\n      }))\n    this.video.nativeElement.volume = this.mVolume\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'volumechange')\n      .subscribe(() => {\n        this.mVolume = this.video.nativeElement.volume\n        this.volumeChange.emit(this.mVolume)\n      }))\n    this.video.nativeElement.playbackRate = this.mPlaybackRate\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'ratechange')\n      .subscribe(() => {\n        this.mPlaybackRate = this.video.nativeElement.playbackRate\n        this.playbackRateChange.emit(this.mPlaybackRate)\n      }))\n    this.subscriptions.push(fromEvent(this.element.nativeElement, 'contextmenu')\n      .subscribe((e: MouseEvent) => {\n        e.preventDefault()\n        const outer = this.element.nativeElement.getBoundingClientRect()\n        const panel = this.contextMenu.nativeElement.getBoundingClientRect()\n        if (e.clientX + panel.width + 20 > outer.right) {\n          if (e.clientY + panel.height + 20 > outer.bottom) {\n            this.mContextMenuPosition = `right: ${outer.right - e.clientX}px; bottom: ${outer.bottom - e.clientY}px`\n          } else {\n            this.mContextMenuPosition = `right: ${outer.right - e.clientX}px; top: ${e.clientY - outer.top}px`\n          }\n        } else {\n          if (e.clientY + panel.height + 20 > outer.bottom) {\n            this.mContextMenuPosition = `left: ${e.clientX - outer.left}px; bottom: ${outer.bottom - e.clientY}px`\n          } else {\n            this.mContextMenuPosition = `left: ${e.clientX - outer.left}px; top: ${e.clientY - outer.top}px`\n          }\n        }\n        this.contextMenuState = 'root'\n        this.showContextMenu = true\n      }))\n    this.zone.runOutsideAngular(() => {\n      this.langContextMenuOption.nativeElement.addEventListener('click', this.showLangMenu, true)\n      this.element.nativeElement.addEventListener('click', this.onComponentClicked, true)\n      document.addEventListener('click', this.onDocumentClicked, true)\n    })\n    this.zone.runOutsideAngular(() => {\n      this.showControlChange$.subscribe(showControl => {\n        if (showControl) this.onControlShown()\n        else this.onControlDismiss()\n        this.showControlChange.emit(showControl)\n      })\n    })\n  }\n\n  ngOnDestroy () {\n    this.onUnfocused()\n    this.onControlDismiss()\n    if (this.timeUpdate) {\n      this.timeUpdate.unsubscribe()\n      this.timeUpdate = null\n    }\n    this.subscriptions.forEach(sub => sub.unsubscribe())\n    this.subscriptions = []\n    this.langContextMenuOption.nativeElement.removeEventListener('click', this.showLangMenu, true)\n    this.element.nativeElement.removeEventListener('click', this.onComponentClicked, true)\n    document.removeEventListener('click', this.onDocumentClicked, true)\n  }\n\n  private updateSources () {\n    if (this.mSources.length === 0) {\n      this.sources = [{\n        shortName: 'Default',\n        name: 'Default',\n        default: true,\n        sources: [{ src: this.mSrc, type: undefined }]\n      }]\n    } else {\n      const sm = {}\n      this.mSources.forEach(source => {\n        if (!source.shortname) {\n          source.shortname = 'Untitled'\n        }\n        if (!sm[source.shortname]) {\n          sm[source.shortname] = {\n            shortName: source.shortname,\n            name: source.name || 'Untitled',\n            sources: []\n          }\n        }\n        sm[source.shortname].sources.push(source)\n        if (source.default !== undefined && source.default !== null) {\n          sm[source.shortname].default = true\n        }\n      })\n      this.sources = Object.values(sm)\n    }\n    const indexOfDefault = this.sources.findIndex(s => s.default)\n    this.playingSource = indexOfDefault >= 0 ? indexOfDefault : 0\n  }\n\n  private async updateSubtitles () {\n    const parsedSubtitles = []\n    for (const sub of this.mSubtitles) {\n      let text = ''\n      if (sub.value) text = sub.value\n      else if (sub.src) {\n        const resp = await fetch(sub.src)\n        text = await resp.text()\n      }\n      const parsed = {\n        name: sub.name || 'Untitled',\n        class: sub.class || '',\n        parsedSubtitles: undefined,\n        enabled: sub.default !== undefined && sub.default !== null\n          || sub.srclang === this.service.i18n.language\n      }\n      sub.type = sub.type || ''\n      sub.type = sub.type.toLowerCase()\n      if (sub.type !== 'text/vtt' && sub.type !== 'application/x-subrip') {\n        console.warn('Unknown MIME type of subtitles, trying to infer subtitle format. Supported type: text/vtt, application/x-subrip.')\n      }\n      try {\n        parsed.parsedSubtitles = this.service.parseSubtitles(text)\n      } catch (e) {\n        console.error(e)\n      }\n      parsedSubtitles.push(parsed)\n    }\n    this.subtitles = parsedSubtitles\n    this.updateFlyingSubtitles()\n  }\n\n  private updateFlyingSubtitles (currentTime?) {\n    if (currentTime === undefined) {\n      currentTime = this.video.nativeElement.currentTime\n    }\n    currentTime *= 1000\n    const flyingSubtitles = []\n    this.enabledSubtitles.forEach(subtitles => {\n      if (!subtitles.parsedSubtitles) return\n      const flyingSubtitlesTrack = []\n      subtitles.parsedSubtitles.forEach(subtitle => {\n        if (currentTime > subtitle.startTime && currentTime < subtitle.endTime) {\n          flyingSubtitlesTrack.push({\n            ...subtitle,\n            texts: subtitle.texts.map(text => this.sanitization.bypassSecurityTrustHtml(text))\n          })\n        }\n      })\n      if (flyingSubtitlesTrack.length) {\n        flyingSubtitles.push({\n          name: subtitles.name,\n          class: subtitles.class,\n          parsedSubtitles: flyingSubtitlesTrack\n        })\n      }\n    })\n    this.flyingSubtitles = flyingSubtitles\n  }\n\n  private setAllControlPanelsPosition () {\n    setTimeout(() => {\n      [{\n        btn: this.settingsBtn,\n        panel: this.settingsPanel,\n        name: 'settings'\n      }, {\n        btn: this.sourceBtn,\n        panel: this.sourcePanel,\n        name: 'source'\n      }, {\n        btn: this.subtitlesBtn,\n        panel: this.subtitlesPanel,\n        name: 'subtitles'\n      }, {\n        btn: this.loopBtn,\n        panel: this.loopPanel,\n        name: 'loop'\n      }, {\n        btn: this.fullScreenBtn,\n        panel: this.fullScreenPanel,\n        name: 'fullscreen'\n      }].forEach(item => this.setPanelPosition(item.btn, item.panel, item.name))\n      this.changeDetectorRef.detectChanges()\n    }, 0)\n  }\n\n  private setPanelPosition (btn, panel, name) {\n    if (!this.element || !panel || !btn) return\n    const outerRect = this.element.nativeElement.getBoundingClientRect()\n    const panelRect = panel.nativeElement.getBoundingClientRect()\n    const btnRect = btn.nativeElement.getBoundingClientRect()\n    if (panelRect.width / 2 - outerRect.right + btnRect.right > 0) {\n      this.panelTranslations[name] = panelRect.width / 2 - outerRect.right + btnRect.right\n    } else {\n      this.panelTranslations[name] = 0\n    }\n  }\n\n  onSlotChange (e) {\n    this.subtitlesSlotUpdate$.next(\n      e.target.assignedNodes().filter(node => node.nodeName === 'USHIO-SUBTITLES')\n    )\n    this.sourcesSlotUpdate$.next(\n      e.target.assignedNodes().filter(node => node.nodeName === 'USHIO-SOURCE')\n    )\n    this.mInjectedStyles = e.target.assignedNodes()\n      .filter(node => node.nodeName === 'STYLE').map(node => node.innerHTML)\n  }\n\n  onVideoMaskClicked () {\n    if (this.interactMode === 'desktop') {\n      this.togglePlay()\n    } else {\n      this.mobileShowControlStateChange$.next({\n        showControl: !this.mShowControl,\n        delaySwitch: true\n      })\n    }\n  }\n\n  onSelectSource (i) {\n    if (i === this.playingSource) return\n    const currentTime = this.mCurrentTime\n    const paused = this.mPaused\n    this.playingSource = i\n    this.video.nativeElement.load()\n    this.video.nativeElement.currentTime = currentTime\n    if (!paused) this.video.nativeElement.play()\n  }\n\n  onCheckSubtitles (i) {\n    this.subtitles[i].enabled = !this.subtitles[i].enabled\n    this.updateFlyingSubtitles()\n  }\n\n  togglePlay () {\n    if (this.video.nativeElement.paused) this.video.nativeElement.play()\n    else this.video.nativeElement.pause()\n  }\n\n  toggleMute () {\n    if (this.interactMode === 'desktop') {\n      this.video.nativeElement.muted = !(this.video.nativeElement.muted || this.video.nativeElement.volume === 0)\n      this.mutedChange.emit(this.video.nativeElement.muted)\n    } else if (this.video.nativeElement.muted) {\n      this.video.nativeElement.muted = false\n      this.mutedChange.emit(false)\n    }\n    if (!this.video.nativeElement.muted && this.video.nativeElement.volume === 0) {\n      this.video.nativeElement.volume = Math.random()\n    }\n  }\n\n  toggleLoop () {\n    this.video.nativeElement.loop = !this.video.nativeElement.loop\n    this.loopChange.emit(this.video.nativeElement.loop)\n  }\n\n  toggleFullscreen () {\n    if (!this.isFullScreen) {\n      this.element.nativeElement.requestFullscreen()\n    } else {\n      document.exitFullscreen()\n    }\n  }\n\n  showLangMenu () {\n    this.contextMenuState = 'lang'\n    this.showContextMenu = true\n    this.changeDetectorRef.detectChanges()\n  }\n\n  onComponentClicked () {\n    this.focus = true\n    if (this.keySubscriptions.length === 0) {\n      this.onFocused()\n    }\n  }\n\n  onDocumentClicked () {\n    this.focus = false\n    if (this.showContextMenu) {\n      this.showContextMenu = false\n      this.changeDetectorRef.detectChanges()\n    }\n  }\n\n  setLanguage (code) {\n    this.service.i18n.setLanguage(code)\n  }\n\n  toggleShowStatisticInfoPanel () {\n    this.showStatisticInfoPanel = !this.showStatisticInfoPanel\n    if (this.showStatisticInfoPanel) {\n      this.zone.runOutsideAngular(() => {\n        const animationFrame$ = of(null, animationFrameScheduler).pipe(repeat())\n        this.animationFrame = animationFrame$.subscribe(() => {\n          if (!this.fpsStart) this.fpsStart = +new Date()\n          this.fpsIndex++\n          const fpsCurrent = +new Date()\n          if (fpsCurrent - this.fpsStart > 1000) {\n            this.fps = ((this.fpsIndex / (fpsCurrent - this.fpsStart)) * 1000).toFixed(2)\n            this.fpsStart = +new Date()\n            this.fpsIndex = 0\n            this.changeDetectorRef.detectChanges()\n          }\n        })\n      })\n    } else {\n      this.animationFrame.unsubscribe()\n    }\n  }\n\n}\n","import { CommonModule } from '@angular/common'\nimport { NgModule } from '@angular/core'\n\nimport { UshioComponent, UshioSource, UshioSubtitles } from './ushio.component'\n\n@NgModule({\n  declarations: [\n    UshioComponent,\n    UshioSource,\n    UshioSubtitles\n  ],\n  imports: [\n    CommonModule\n  ],\n  exports: [\n    UshioComponent,\n    UshioSource,\n    UshioSubtitles\n  ]\n})\nexport class UshioModule { }\n"]}