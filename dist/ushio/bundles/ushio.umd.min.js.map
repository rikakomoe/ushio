{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://ushio/lib/ushio.service.ts","ng://ushio/lib/ushio.component.ts","ng://ushio/lib/ushio.module.ts"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","__values","o","m","UshioI18nProvider","lang","i18nSource","en","speed","normal","loop","noLoop","fullscreen","exitFullscreen","statistic","language","mute","zh-Hans","_b","tslib_1.__values","navigator","languages","_c","langCode","setLanguage","bind","defineProperty","entries","map","entry","key","UshioService","timeStampRegex","i18n","version","build","parseSubtitles","input","str","_this","origin","trim","replace","split","splitSubtitles","cachedSubtitle","state","forEach","line","match","exec","startTime","endTime","texts","Error","processLine","Injectable","args","providedIn","UshioSource","Directive","selector","Input","UshioSubtitles","UshioComponent","element","zone","changeDetectorRef","sanitization","service","mInjectedStyles","viewInit","preload","mSources","sources","playingSource","mSubtitles","subtitles","flyingSubtitles","mVolume","volumeChange","EventEmitter","mPlaybackRate","playbackRateChange","mVolumeControl","mSourceControl","mSubtitlesControl","mSettingsControl","mLoopControl","mFullscreenControl","subtitlesSlotUpdate$","Subject","sourcesSlotUpdate$","subtitlesSlotChange$","asObservable","pipe","distinctUntilChanged","sourcesSlotChange$","mobileShowControlStateChange$","showControlProbablyChanged$","showControlChange$","showControl","interactMode","focus","mShowControl","mNoCursor","thumbMouseDown","controlMouseDown","controlHoveredClass","showContextMenu","showStatisticInfoPanel","showVolumeHint","showProgressDetail","showControlChange","mPaused","pausedChange","mCurrentTime","currentTimeChange","duration","durationChange","bufferedTime","waiting","waitingChange","loopChange","mutedChange","fps","fpsStart","fpsIndex","panelTranslations","settings","source","mContextMenuPosition","mProgressDetailPosition","mProgressDetailContainerPosition","mProgressDetailTimePosition","mProgressDetailPositionRate","contextMenuState","subscriptions","mouseSubscriptions","keySubscriptions","mouseMove$","fromEvent","document","mouseUp$","touchMove$","touchStart$","touchEnd$","merge","mouseTouchUp$","showLangMenu","onComponentClicked","onDocumentClicked","style","bypassSecurityTrustHtml","mSrc","src","updateSources","filter","enabled","volume","video","nativeElement","muted","Math","round","playbackRate","volumeControl","setAllControlPanelsPosition","sourceControl","subtitlesControl","settingsControl","loopControl","fullscreenControl","fullscreenElement","mouseDown","enabledSubtitles","isFullScreen","paused","pause","play","currentTime","formatDuration","bypassSecurityTrustStyle","volume100","mapSpeedToProgress","height","videoHeight","videoWidth","thumbnails","ceil","toFixed","mapProgressToSpeed","progress","floor","h","ngOnInit","ngAfterContentInit","mapPropsToObject","props","fn","sourceObj","reduce","agg","cur","_a","onContentChildrenOrSlotChanged$","attr","contentChildren","slotChange$","contentChildrenMap","obj","slotMap","getAttribute","of","toArray","changes","contents","subtitlesChange$","subtitlesContentChildren","sourcesChange$","sourceContentChildren","runOutsideAngular","subscribe","updateSubtitles","detectChanges","onUnfocused","sub","unsubscribe","onFocused","onKeyDown$","code","tap","preventDefault","stopPropagation","togglePlay","showVolumeHint$","switchMap","timer","mapTo","onControlDismiss","controlHoveredChange","onControlShown","ifMouseInArea","btnElement","popUpElement","rect1","getBoundingClientRect","rect2","clientX","left","right","clientY","top","bottom","mouseHoverProgressState$","rect","slider","yCenter","abs","containerLeft","width","timeLeft","a","b","mapToRate","total","moveEvent","eventCoordinate","TouchEvent","changedTouches","onMouseTouchDown$","onMouseTouchDrag$","concatMap","takeUntil","thumbMouseTouchDown$","thumbTouchDrag$","timeUpdate","subscribeTimeUpdate","btns","controlHoverStateChange$","volumeBtn","volumePanel","btnName","settingsBtn","settingsPanel","sourceBtn","sourcePanel","subtitlesBtn","subtitlesPanel","btns_1","btns_1_1","btn","subscribeControlHoveredChange","volumeMouseTouchDown$","volumeBar","volumeTouchDrag$","speedMouseTouchDown$","speedBar","speedTouchDrag$","emit","updateFlyingSubtitles","ngAfterViewInit","desktopShowControlStateChange$","delaySwitch","showControlStateChange$","noCursor","NEVER","timeRanges","end","start","buffered","outer","panel","contextMenu","langContextMenuOption","addEventListener","ngOnDestroy","clearTimeout","setAllControlPanelsPositionTimeout","removeEventListener","shortName","name","default","type","undefined","sm_1","shortname","values","indexOfDefault","findIndex","load","parsedSubtitles","text","fetch","_d","parsed","class","srclang","toLowerCase","console","warn","error","flyingSubtitlesTrack","subtitle","setTimeout","loopBtn","loopPanel","fullScreenBtn","fullScreenPanel","item","setPanelPosition","outerRect","panelRect","btnRect","onSlotChange","target","assignedNodes","node","nodeName","innerHTML","onVideoMaskClicked","onSelectSource","onCheckSubtitles","toggleMute","random","toggleLoop","toggleFullscreen","requestFullscreen","toggleShowStatisticInfoPanel","animationFrame$","animationFrameScheduler","repeat","animationFrame","Date","fpsCurrent","Component","template","encapsulation","ViewEncapsulation","ShadowDom","ElementRef","NgZone","ChangeDetectorRef","DomSanitizer","Output","ViewChild","static","ContentChildren","UshioModule","NgModule","declarations","imports","CommonModule","exports"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { Injectable } from '@angular/core'\n\nexport interface ISubtitle {\n  startTime: number\n  endTime: number\n  texts: string[]\n}\n\nclass UshioI18nProvider {\n  private lang = 'en'\n  private readonly i18nSource = {\n    en: {\n      lang: 'English',\n      speed: 'Speed',\n      normal: 'Normal',\n      loop: 'Loop',\n      noLoop: 'No Loop',\n      fullscreen: 'Fullscreen',\n      exitFullscreen: 'Exit fullscreen',\n      statistic: 'Video statistic',\n      language: 'Language',\n      mute: 'Mute'\n    },\n    'zh-Hans': {\n      lang: 'ç®ä½ä¸­æ',\n      speed: 'æ­æ¾éåº¦',\n      normal: 'æ­£å¸¸',\n      loop: 'å¾ªç¯æ­æ¾',\n      noLoop: 'å³é­å¾ªç¯',\n      fullscreen: 'å¨å±æ­æ¾',\n      exitFullscreen: 'éåºå¨å±',\n      statistic: 'è§é¢ç»è®¡ä¿¡æ¯',\n      language: 'è¯­è¨',\n      mute: 'éé³'\n    }\n  }\n  get languages () {\n    return Object.entries(this.i18nSource).map(entry => [entry[0], entry[1].lang])\n  }\n  get language () {\n    return this.lang\n  }\n\n  constructor () {\n    for (const langCode of navigator.languages) {\n      if (this.setLanguage(langCode)) break\n    }\n    this.t = this.t.bind(this)\n  }\n\n  setLanguage (langCode): boolean {\n    if (this.i18nSource[langCode]) {\n      this.lang = langCode\n      return true\n    }\n    return false\n  }\n\n  t (key: string): string {\n    return this.i18nSource[this.lang][key]\n  }\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UshioService {\n\n  static version = '4.1.3'\n  static build = 'NG Build'\n\n  // tslint:disable-next-line:max-line-length\n  private readonly timeStampRegex = /^(?:(\\d{2,})(:))?([0-5][0-9])(:)([0-5][0-9])([,.])(\\d{3})( --> )(?:(\\d{2,})(:))?([0-5][0-9])(:)([0-5][0-9])([,.])(\\d{3})/\n  i18n = new UshioI18nProvider()\n  get version () {\n    return UshioService.version\n  }\n  get build () {\n    return UshioService.build\n  }\n\n  constructor () { }\n\n  parseSubtitles (input: string): ISubtitle[] {\n    const trim = (str: string) => str.trim()\n      .replace(/^[^\\S\\n]+/gm, '')\n      .replace(/\\u0000/g, '\\uFFFD')\n      .replace(/\\r\\n/g, '\\n')\n      .replace(/\\r/g, '\\n')\n      .replace(/\\n{3,}/g, '\\n\\n')\n    const origin = trim(input)\n      .split('\\n')\n    const splitSubtitles: ISubtitle[] = []\n    let cachedSubtitle: ISubtitle | null = null\n    let state = 'root'\n    const processLine = (line: string) => {\n      switch (state) {\n        case 'note':\n        /* falls through */\n        case 'title':\n          if (line === '') {\n            state = 'root'\n          }\n          return\n        case 'root':\n          if (line.match(/^WEBVTT/)) {\n            state = 'title'\n            return\n          } else if (line.match(/^NOTE/)) {\n            state = 'note'\n            return\n          } else if (line === '') return [line]\n          else if (!line.match(/-->/)) {\n            state = 'timeline'\n            return\n          }\n        /* falls through */\n        case 'timeline':\n          const match = this.timeStampRegex.exec(line)\n          if (match) {\n            cachedSubtitle = {\n              startTime: 1000 * (60 * (60 * +match[1] + +match[3]) + +match[5]) + +match[7] || 0,\n              endTime: 1000 * (60 * (60 * +match[9] + +match[11]) + +match[13]) + +match[15] || 0,\n              texts: []\n            }\n            state = 'text'\n            return\n          } else {\n            throw new Error(`unexpected timeline token: ${line}`)\n          }\n        case 'text':\n          if (line === '') {\n            state = 'root'\n            if (cachedSubtitle) {\n              splitSubtitles.push(cachedSubtitle)\n              cachedSubtitle = null\n            }\n          } else if (cachedSubtitle) {\n            cachedSubtitle.texts.push(line)\n          }\n      }\n    }\n    origin.forEach(line => processLine(line))\n    if (cachedSubtitle) splitSubtitles.push(cachedSubtitle)\n    return splitSubtitles\n  }\n\n}\n","import {\n  AfterContentInit,\n  AfterViewInit, ChangeDetectorRef,\n  Component,\n  ContentChildren,\n  Directive,\n  ElementRef, EventEmitter,\n  Input, NgZone,\n  OnDestroy,\n  OnInit, Output,\n  QueryList,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core'\nimport { DomSanitizer, SafeStyle } from '@angular/platform-browser'\nimport {\n  animationFrameScheduler,\n  fromEvent, merge, NEVER, Observable, of,\n  Subject, Subscription, timer\n} from 'rxjs'\nimport {\n  concatMap, distinctUntilChanged,\n  filter, map, mapTo, repeat, switchMap, takeUntil, tap\n} from 'rxjs/operators'\n\nimport { ISubtitle, UshioService } from './ushio.service'\n\n@Directive({\n  // tslint:disable-next-line:directive-selector\n  selector: 'ushio-source'\n})\nexport class UshioSource {\n  @Input() src!: string\n  @Input() type: string\n  @Input() shortname: string\n  @Input() name: string\n  @Input() default: boolean\n}\n\n@Directive({\n  // tslint:disable-next-line:directive-selector\n  selector: 'ushio-subtitles'\n})\nexport class UshioSubtitles {\n  @Input() value: string\n  @Input() src: string\n  @Input() type: string\n  @Input() name: string\n  @Input() class: string\n  @Input() srclang: string\n  @Input() default: boolean\n}\n\ninterface Source {\n  shortName: string\n  name: string\n  sources: {\n    src: string;\n    type: string;\n  }[]\n  default?: boolean\n}\n\ninterface Subtitles {\n  name: string\n  class: string\n  parsedSubtitles: ISubtitle[]\n  enabled: boolean\n}\n\n@Component({\n  selector: 'ushio-player',\n  templateUrl: './ushio.component.html',\n  styleUrls: ['./ushio.component.styl'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class UshioComponent implements OnInit, AfterContentInit, AfterViewInit, OnDestroy {\n\n  private mInjectedStyles = []\n  get injectedStyles () {\n    return this.mInjectedStyles.map(\n      style => this.sanitization.bypassSecurityTrustHtml(`\n      <style>\n       ${style}\n      </style>\n    `))\n  }\n\n  private viewInit = false\n\n  @Input() set src (src) {\n    this.mSrc = src\n    this.updateSources()\n  }\n  get src () {\n    return this.mSrc\n  }\n  @Input() poster\n  @Input() crossorigin\n  @Input() autoplay\n  @Input() preload = 'metadata'\n  @Input() set lang (lang: string) {\n    this.service.i18n.setLanguage(lang)\n  }\n  @Input() thumbnails\n\n  private mSrc\n  private mSources = []\n  sources: Source[] = []\n  playingSource = 0\n\n  private mSubtitles = []\n  subtitles: Subtitles[] = []\n  get enabledSubtitles () {\n    return this.subtitles.filter(s => s.enabled)\n  }\n  flyingSubtitles: Subtitles[] = []\n\n  private mVolume = 1\n  @Input() set volume (volume) {\n    this.video.nativeElement.volume = volume\n  }\n  get volume100 () {\n    if (this.video.nativeElement.muted) return 0\n    return Math.round(this.mVolume * 100)\n  }\n  @Output() volumeChange = new EventEmitter<number>()\n\n  private mPlaybackRate = 1\n  @Input() set playbackRate (playbackRate) {\n    this.video.nativeElement.playbackRate = playbackRate\n  }\n  @Output() playbackRateChange = new EventEmitter<number>()\n\n  private mVolumeControl = true\n  @Input() set volumeControl (volumeControl) {\n    this.mVolumeControl = volumeControl\n    this.setAllControlPanelsPosition()\n  }\n  get volumeControl () {\n    return this.mVolumeControl\n  }\n  private mSourceControl = true\n  @Input() set sourceControl (sourceControl) {\n    this.mSourceControl = sourceControl\n    this.setAllControlPanelsPosition()\n  }\n  get sourceControl () {\n    return this.mSourceControl\n  }\n  private mSubtitlesControl = true\n  @Input() set subtitlesControl (subtitlesControl) {\n    this.mSubtitlesControl = subtitlesControl\n    this.setAllControlPanelsPosition()\n  }\n  get subtitlesControl () {\n    return this.mSubtitlesControl\n  }\n  private mSettingsControl = true\n  @Input() set settingsControl (settingsControl) {\n    this.mSettingsControl = settingsControl\n    this.setAllControlPanelsPosition()\n  }\n  get settingsControl () {\n    return this.mSettingsControl\n  }\n  private mLoopControl = true\n  @Input() set loopControl (loopControl) {\n    this.mLoopControl = loopControl\n    this.setAllControlPanelsPosition()\n  }\n  get loopControl () {\n    return this.mLoopControl\n  }\n  private mFullscreenControl = true\n  @Input() set fullscreenControl (fullscreenControl) {\n    this.mFullscreenControl = fullscreenControl\n    this.setAllControlPanelsPosition()\n  }\n  get fullscreenControl () {\n    return this.mFullscreenControl\n  }\n\n  @ViewChild('video', { static: true }) video\n  @ViewChild('slider', { static: true }) slider\n  @ViewChild('volumeBar', { static: true }) volumeBar\n  @ViewChild('volumePanel', { static: true }) volumePanel\n  @ViewChild('volumeBtn', { static: true }) volumeBtn\n  @ViewChild('settingsPanel', { static: true }) settingsPanel\n  @ViewChild('settingsBtn', { static: true }) settingsBtn\n  @ViewChild('speedBar', { static: true }) speedBar\n  @ViewChild('sourcePanel', { static: true }) sourcePanel\n  @ViewChild('sourceBtn', { static: true }) sourceBtn\n  @ViewChild('subtitlesPanel', { static: true }) subtitlesPanel\n  @ViewChild('subtitlesBtn', { static: true }) subtitlesBtn\n  @ViewChild('loopBtn', { static: true }) loopBtn\n  @ViewChild('loopPanel', { static: true }) loopPanel\n  @ViewChild('fullScreenBtn', { static: true }) fullScreenBtn\n  @ViewChild('fullScreenPanel', { static: true }) fullScreenPanel\n  @ViewChild('contextMenu', { static: true }) contextMenu\n  @ViewChild('langContextMenuOption', { static: true }) langContextMenuOption\n\n  @ContentChildren(UshioSource) sourceContentChildren!: QueryList<UshioSource>\n  @ContentChildren(UshioSubtitles) subtitlesContentChildren!: QueryList<UshioSubtitles>\n  private subtitlesSlotUpdate$ = new Subject<HTMLElement[]>()\n  private sourcesSlotUpdate$ = new Subject<HTMLElement[]>()\n  private subtitlesSlotChange$ = this.subtitlesSlotUpdate$.asObservable().pipe(distinctUntilChanged())\n  private sourcesSlotChange$ = this.sourcesSlotUpdate$.asObservable().pipe(distinctUntilChanged())\n  private mobileShowControlStateChange$ = new Subject<{ showControl: boolean, delaySwitch: boolean }>()\n  private showControlProbablyChanged$ = new Subject()\n  private showControlChange$ = this.showControlProbablyChanged$.asObservable().pipe(\n    map(() => this.showControl),\n    distinctUntilChanged()\n  )\n\n  interactMode: 'desktop' | 'mobile' = 'desktop'\n  private focus = false\n  private mShowControl = false\n  private mNoCursor = false\n  private thumbMouseDown = false\n  private controlMouseDown = false\n  controlHoveredClass = ''\n  private showContextMenu = false\n  private showStatisticInfoPanel = false\n  private showVolumeHint = false\n  private showProgressDetail = false\n  get isFullScreen (): boolean {\n    return document.fullscreenElement !== null\n  }\n  get mouseDown (): boolean {\n    return this.thumbMouseDown || this.controlMouseDown\n  }\n  get showControl () {\n    return !!(this.mShowControl || this.controlHoveredClass || this.mouseDown)\n  }\n  get noCursor () {\n    return !this.showControl && this.mNoCursor\n  }\n  @Output() showControlChange = new EventEmitter<boolean>()\n  get thumbMouseDownClass (): string {\n    return this.thumbMouseDown ? ' thumb-mouse-down' : ''\n  }\n  get pausedClass (): string {\n    return this.mPaused ? ' video-state-pause' : ' video-state-play'\n  }\n  get waitingClass (): string {\n    return this.waiting && !this.mPaused ? ' video-state-waiting' : ''\n  }\n  get mutedClass (): string {\n    return (this.video.nativeElement.muted || this.video.nativeElement.volume === 0)\n      ? ' video-state-muted' : ' video-state-volume'\n  }\n  get loopClass (): string {\n    return this.video.nativeElement.loop ? ' video-state-loop' : ' video-state-noloop'\n  }\n  get subtitleEnabledClass (): string {\n    return this.enabledSubtitles.length > 0 ? ' video-state-subtitles' : ' video-state-nosubtitles'\n  }\n  get fullscreenClass (): string {\n    return this.isFullScreen ? ' video-state-fullscreen' : ' video-state-nofullscreen'\n  }\n  get contextMenuClass (): string {\n    return this.contextMenuState + (this.showContextMenu ? ' active' : '')\n  }\n  get statisticInfoPanelClass (): string {\n    return this.showStatisticInfoPanel ? ' active' : ''\n  }\n  get volumeHintClass (): string {\n    return this.showVolumeHint ? ' active' : ''\n  }\n  get progressDetailClass (): string {\n    return this.showProgressDetail ? ' active' : ''\n  }\n\n  private mPaused = true\n  @Input() set paused (paused) {\n    if (paused) this.video.nativeElement.pause()\n    else this.video.nativeElement.play()\n  }\n  @Output() pausedChange = new EventEmitter<boolean>()\n  private mCurrentTime = 0\n  @Input() set currentTime (currentTime) {\n    this.video.nativeElement.currentTime = currentTime\n  }\n  @Output() currentTimeChange = new EventEmitter<number>()\n  private duration = 0\n  @Output() durationChange = new EventEmitter<number>()\n  private bufferedTime = 0\n  private waiting = false\n  @Output() waitingChange = new EventEmitter<boolean>()\n  @Input() set loop (loop) {\n    this.video.nativeElement.loop = loop\n  }\n  @Output() loopChange = new EventEmitter<boolean>()\n  @Input() set muted (muted) {\n    this.video.nativeElement.muted = muted\n  }\n  @Output() mutedChange = new EventEmitter<boolean>()\n\n  fps = '0.00'\n  private fpsStart = 0\n  private fpsIndex = 0\n\n  get currentTimeStr (): string {\n    return UshioComponent.formatDuration(this.mCurrentTime)\n  }\n  get durationStr (): string {\n    return UshioComponent.formatDuration(this.duration)\n  }\n  get bufferedProgress (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: scaleX(${this.bufferedTime / this.duration})`\n    )\n  }\n  get playedProgress (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: scaleX(${this.mCurrentTime / this.duration})`\n    )\n  }\n  get thumbPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `left: ${this.mCurrentTime / this.duration * 100}%`\n    )\n  }\n  get volumeRate (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: scaleY(${this.volume100 / 100})`\n    )\n  }\n  get volumeThumbPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `bottom: ${this.volume100}%`\n    )\n  }\n  get speedThumbPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `left: ${UshioComponent.mapSpeedToProgress(this.mPlaybackRate)}%`\n    )\n  }\n  private panelTranslations = {\n    settings: 0,\n    source: 0,\n    subtitles: 0,\n    loop: 0,\n    fullscreen: 0\n  }\n  get settingsPanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.settings}px - 50%))`\n    )\n  }\n  get sourcePanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.source}px - 50%))`\n    )\n  }\n  get subtitlesPanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.subtitles}px - 50%))`\n    )\n  }\n  get loopPanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.loop}px - 50%))`\n    )\n  }\n  get fullScreenPanelPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(\n      `transform: translateX(calc(${-this.panelTranslations.fullscreen}px - 50%))`\n    )\n  }\n  private mContextMenuPosition = ''\n  get contextMenuPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(this.mContextMenuPosition)\n  }\n  private mProgressDetailPosition = ''\n  private mProgressDetailContainerPosition = ''\n  private mProgressDetailTimePosition = ''\n  private mProgressDetailPositionRate = 0\n  get progressDetailPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(this.mProgressDetailPosition)\n  }\n  get progressDetailContainerPosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(this.mProgressDetailContainerPosition)\n  }\n  get progressDetailTimePosition (): SafeStyle {\n    return this.sanitization.bypassSecurityTrustStyle(this.mProgressDetailTimePosition)\n  }\n  get progressDetailImgStyle (): SafeStyle {\n    const height = this.video.nativeElement.videoHeight * 160 / this.video.nativeElement.videoWidth\n    return this.sanitization.bypassSecurityTrustStyle(\n      `height: ${height}px;\n       line-height: ${height}px;\n       background-image: url(\"${this.thumbnails}\");\n       background-position: -${(Math.ceil(this.mProgressDetailPositionRate * 100) - 1) * 160}px 0;`\n    )\n  }\n  get progressDetailTime (): string {\n    return UshioComponent.formatDuration(this.mProgressDetailPositionRate * this.duration)\n  }\n\n  languages = this.service.i18n.languages\n  contextMenuState = 'root'\n  get version () {\n    return this.service.version\n  }\n  get detailedVersion () {\n    return `v${this.service.version} (${this.service.build})`\n  }\n  get videoResolution () {\n    return `${this.video.nativeElement.videoWidth} x ${this.video.nativeElement.videoHeight}`\n  }\n  get videoDuration () {\n    return this.video.nativeElement.duration.toFixed(6)\n  }\n  get videoCurrentTime () {\n    return this.video.nativeElement.currentTime.toFixed(6)\n  }\n\n  private timeUpdate: Subscription\n  private controlHoveredChange: Subscription\n  private animationFrame: Subscription\n  private subscriptions: Subscription[] = []\n  private mouseSubscriptions: Subscription[] = []\n  private keySubscriptions: Subscription[] = []\n  private setAllControlPanelsPositionTimeout: number\n  private mouseMove$ = fromEvent(document, 'mousemove')\n  private mouseUp$ = fromEvent(document, 'mouseup')\n  private touchMove$ = fromEvent(document, 'touchmove')\n  private touchStart$ = fromEvent(document, 'touchstart')\n  private touchEnd$ = merge(\n    fromEvent(document, 'touchend'),\n    fromEvent(document, 'touchcancel')\n  )\n  private mouseTouchUp$ = merge(this.mouseUp$, this.touchEnd$)\n\n  t = this.service.i18n.t\n\n  static mapSpeedToProgress (speed) {\n    if (speed < .5) return 0\n    else if (speed < 1.5) return (speed - .5) * 80\n    else if (speed < 2.0) return 80 + (speed - 1.5) * 40\n    else return 100\n  }\n  static mapProgressToSpeed (progress) {\n    if (progress < .1) return .5\n    else if (progress < .9) return .75 + .25 * Math.floor((progress - 0.1) * 5)\n    else return 2\n  }\n\n  static formatDuration (duration: number) {\n    const h = Math.floor(duration / 3600)\n    const m = Math.floor(duration % 3600 / 60)\n    const s = Math.floor(duration % 60)\n    let str = ''\n    if (h && h < 10) { str += `0${h}:` } else if (h) { str += `${h}:` }\n    if (m < 10) { str += `0${m}:` } else { str += `${m}:` }\n    if (s < 10) { str += `0${s}` } else { str += `${s}` }\n    return str\n  }\n\n  constructor (\n    private element: ElementRef,\n    private zone: NgZone,\n    private changeDetectorRef: ChangeDetectorRef,\n    private sanitization: DomSanitizer,\n    private service: UshioService\n  ) {\n    this.showLangMenu = this.showLangMenu.bind(this)\n    this.onComponentClicked = this.onComponentClicked.bind(this)\n    this.onDocumentClicked = this.onDocumentClicked.bind(this)\n  }\n\n  ngOnInit () {\n    this.mPaused = this.video.nativeElement.paused\n    this.mVolume = this.video.nativeElement.volume\n    this.mPlaybackRate = this.video.nativeElement.playbackRate\n  }\n\n  ngAfterContentInit () {\n    const mapPropsToObject = (props: string[], fn) => (sourceObj: any) => (\n      props.reduce((agg, cur) => ({ ...agg, [cur]: fn(sourceObj, cur) }), {})\n    )\n    const onContentChildrenOrSlotChanged$ = (\n      attr, contentChildren:\n      QueryList<any>,\n      slotChange$: Observable<HTMLElement[]>\n    ) => {\n      const contentChildrenMap = mapPropsToObject(attr, (obj, cur) => (obj[cur]))\n      const slotMap = mapPropsToObject(attr, (obj, cur) => (obj.getAttribute(cur)))\n      return merge(\n        of(contentChildren.toArray().map(contentChildrenMap)),\n        contentChildren.changes.pipe(\n          map((contents: QueryList<any>) => (contents.toArray().map(contentChildrenMap)))\n        ),\n        slotChange$.pipe(\n          map((contents: HTMLElement[]) => (\n            contents.map(slotMap)\n          ))\n        )\n      )\n    }\n    const subtitlesAttr = ['value', 'type', 'src', 'name', 'class', 'default', 'srclang']\n    const subtitlesChange$ = onContentChildrenOrSlotChanged$(\n      subtitlesAttr, this.subtitlesContentChildren, this.subtitlesSlotChange$)\n    const sourcesAttr = ['src', 'type', 'name', 'shortname', 'default']\n    const sourcesChange$ = onContentChildrenOrSlotChanged$(\n      sourcesAttr, this.sourceContentChildren, this.sourcesSlotChange$)\n    this.zone.runOutsideAngular(() => {\n      this.subscriptions.push(subtitlesChange$.subscribe(async (subtitles) => {\n        this.mSubtitles = subtitles\n        await this.updateSubtitles()\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.subscriptions.push(sourcesChange$.subscribe((sources) => {\n        this.mSources = sources\n        this.updateSources()\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n  }\n\n  onUnfocused () {\n    this.keySubscriptions.forEach(sub => sub.unsubscribe())\n    this.keySubscriptions = []\n  }\n\n  onFocused () {\n    const onKeyDown$ = code => fromEvent(document, 'keydown').pipe(\n      filter((e: KeyboardEvent) => this.focus && e.code === code),\n      tap(e => {\n        e.preventDefault()\n        e.stopPropagation()\n      })\n    )\n    this.zone.runOutsideAngular(() => {\n      this.keySubscriptions.push(onKeyDown$('Space').subscribe(e => {\n        this.togglePlay()\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.keySubscriptions.push(onKeyDown$('ArrowRight').subscribe(() => {\n        this.mCurrentTime = this.mCurrentTime + 5 < this.duration ? this.mCurrentTime + 5 : this.duration\n        this.video.nativeElement.currentTime = this.mCurrentTime\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.keySubscriptions.push(onKeyDown$('ArrowLeft').subscribe(() => {\n        this.mCurrentTime = this.mCurrentTime - 5 > 0 ? this.mCurrentTime - 5 : 0\n        this.video.nativeElement.currentTime = this.mCurrentTime\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.keySubscriptions.push(onKeyDown$('ArrowUp').subscribe(() => {\n        this.mVolume = this.mVolume + 0.1 < 0.999996 ? this.mVolume + 0.1 : 1\n        this.video.nativeElement.volume = this.mVolume\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.keySubscriptions.push(onKeyDown$('ArrowDown').subscribe(() => {\n        this.mVolume = this.mVolume - 0.1 > 0.000004 ? this.mVolume - 0.1 : 0\n        this.video.nativeElement.volume = this.mVolume\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n    const showVolumeHint$ = merge(onKeyDown$('ArrowUp'), onKeyDown$('ArrowDown'))\n      .pipe(\n        switchMap(\n          () => merge(of(true), timer(1000).pipe(mapTo(false)))\n        ),\n        distinctUntilChanged()\n      )\n    this.zone.runOutsideAngular(() => {\n      this.keySubscriptions.push(showVolumeHint$.subscribe(e => {\n        this.showVolumeHint = e\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.setAllControlPanelsPosition()\n    })\n  }\n\n  onControlDismiss () {\n    this.mouseSubscriptions.forEach(sub => sub.unsubscribe())\n    this.mouseSubscriptions = []\n    if (this.controlHoveredChange) {\n      this.controlHoveredChange.unsubscribe()\n      this.controlHoveredChange = null\n    }\n  }\n\n  onControlShown () {\n    const ifMouseInArea = (e: MouseEvent, btnElement, popUpElement) => {\n      const rect1 = popUpElement.getBoundingClientRect()\n      const rect2 = btnElement.getBoundingClientRect()\n      return (e.clientX > rect1.left &&\n        e.clientX < rect1.right &&\n        e.clientY > rect1.top &&\n        e.clientY < rect1.bottom) || (e.clientX > rect2.left &&\n        e.clientX < rect2.right &&\n        e.clientY > rect2.top &&\n        e.clientY < rect2.bottom)\n    }\n    const onControlBtnHoverStateChanged$ = (btns) => {\n      return this.mouseMove$.pipe(\n        switchMap((e: MouseEvent) => {\n          for (const btn of btns) {\n            if (ifMouseInArea(e, btn.btnElement, btn.popUpElement)) {\n              return of(` btn-${btn.btnName}-hover`)\n            }\n          }\n          return timer(150).pipe(\n            mapTo('')\n          )\n        }),\n        distinctUntilChanged()\n      )\n    }\n    const mouseHoverProgressState$ = this.mouseMove$.pipe(\n      filter(() => (this.interactMode === 'desktop')),\n      map((e: MouseEvent) => {\n        const rect = this.slider.nativeElement.getBoundingClientRect()\n        const yCenter = (rect.top + rect.bottom) / 2\n        if (Math.abs(e.clientY - yCenter) < 8 && e.clientX > rect.left && e.clientX < rect.right) {\n          const left = e.clientX - rect.left\n          const containerLeft = left < 80 ? 90 - left : left > rect.width - 80 ? rect.width - left - 70 : 10\n          const timeLeft = left < 20 ? 30 - left : left > rect.width - 20 ? rect.width - left - 10 : 10\n          return { left, containerLeft, timeLeft, width: rect.width }\n        } else {\n          return false\n        }\n      }),\n      distinctUntilChanged((a, b) => {\n        if (typeof a !== typeof b) {\n          return false\n        } else if (typeof a === 'object' && typeof b === 'object') {\n          return a.left === b.left && a.containerLeft === b.containerLeft\n            && a.timeLeft === b.timeLeft && a.width === b.width\n        } else {\n          return a === b\n        }\n      })\n    )\n    this.zone.runOutsideAngular(() => {\n      this.mouseSubscriptions.push(mouseHoverProgressState$.subscribe(state => {\n        if (typeof state === 'boolean') {\n          this.showProgressDetail = state\n        } else {\n          this.showProgressDetail = true\n          this.mProgressDetailPosition = `left: ${state.left}px`\n          this.mProgressDetailContainerPosition = `left: ${state.containerLeft}px`\n          this.mProgressDetailTimePosition = `left: ${state.timeLeft}px`\n          this.mProgressDetailPositionRate = state.left / state.width\n        }\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n    const mapToRate = (element, progress, total) => map(\n      (moveEvent: MouseEvent | TouchEvent) => {\n        const eventCoordinate = moveEvent instanceof TouchEvent\n          ? moveEvent.changedTouches[0]\n          : moveEvent\n        const rect = element.getBoundingClientRect()\n        let p = progress(eventCoordinate, rect)\n        const t = total(rect)\n        if (p < 0) p = 0\n        else if (p > t) p = t\n        return p / t\n      }\n    )\n    const onMouseTouchDown$ = (element, progress, total) => {\n      return merge(\n        fromEvent(element, 'mousedown'),\n        fromEvent(element, 'touchstart')\n      ).pipe(\n        mapToRate(element, progress, total)\n      )\n    }\n    const onMouseTouchDrag$ = (element, progress, total) => {\n      return merge(\n        fromEvent(element, 'mousedown').pipe(\n          mapToRate(element, progress, total),\n          concatMap(() => {\n            return this.mouseMove$.pipe(\n              takeUntil(this.mouseUp$),\n              mapToRate(element, progress, total)\n            )\n          })\n        ),\n        fromEvent(element, 'touchstart').pipe(\n          mapToRate(element, progress, total),\n          concatMap(() => {\n            return this.touchMove$.pipe(\n              takeUntil(this.touchEnd$),\n              mapToRate(element, progress, total)\n            )\n          })\n        )\n      )\n    }\n    const thumbMouseTouchDown$ = onMouseTouchDown$(\n      this.slider.nativeElement,\n      (moveEvent, rect) => (moveEvent.clientX - rect.left),\n      (rect) => (rect.width)\n    )\n    const thumbTouchDrag$ = onMouseTouchDrag$(\n      this.slider.nativeElement,\n      (moveEvent, rect) => (moveEvent.clientX - rect.left),\n      (rect) => (rect.width)\n    )\n    this.zone.runOutsideAngular(() => {\n      this.mouseSubscriptions.push(thumbMouseTouchDown$.subscribe(e => {\n        this.thumbMouseDown = true\n        this.timeUpdate.unsubscribe()\n        this.mCurrentTime = e * this.duration\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(thumbTouchDrag$.subscribe(e => {\n        this.mCurrentTime = e * this.duration\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(this.mouseTouchUp$.subscribe(() => {\n        if (this.thumbMouseDown) {\n          this.video.nativeElement.currentTime = this.mCurrentTime\n          this.subscribeTimeUpdate()\n          this.thumbMouseDown = false\n          this.showControlProbablyChanged$.next(0)\n          this.changeDetectorRef.detectChanges()\n        }\n      }))\n    })\n    const controlHoverStateChange$ = onControlBtnHoverStateChanged$([{\n      btnElement: this.volumeBtn.nativeElement,\n      popUpElement: this.volumePanel.nativeElement,\n      btnName: 'volume'\n    }, {\n      btnElement: this.settingsBtn.nativeElement,\n      popUpElement: this.settingsPanel.nativeElement,\n      btnName: 'settings'\n    }, {\n      btnElement: this.sourceBtn.nativeElement,\n      popUpElement: this.sourcePanel.nativeElement,\n      btnName: 'source'\n    }, {\n      btnElement: this.subtitlesBtn.nativeElement,\n      popUpElement: this.subtitlesPanel.nativeElement,\n      btnName: 'subtitles'\n    }])\n    const subscribeControlHoveredChange = () => {\n      this.zone.runOutsideAngular(() => {\n        this.controlHoveredChange = controlHoverStateChange$.subscribe(e => {\n          this.controlHoveredClass = e\n          this.showControlProbablyChanged$.next(0)\n          this.setAllControlPanelsPosition()\n          this.changeDetectorRef.detectChanges()\n        })\n      })\n    }\n    subscribeControlHoveredChange()\n    const volumeMouseTouchDown$ = onMouseTouchDown$(\n      this.volumeBar.nativeElement,\n      (moveEvent, rect) => (rect.bottom - moveEvent.clientY),\n      (rect) => (rect.height)\n    )\n    const volumeTouchDrag$ = onMouseTouchDrag$(\n      this.volumeBar.nativeElement,\n      (moveEvent, rect) => (rect.bottom - moveEvent.clientY),\n      (rect) => (rect.height)\n    )\n    this.zone.runOutsideAngular(() => {\n      this.mouseSubscriptions.push(volumeMouseTouchDown$.subscribe(e => {\n        if (!this.controlMouseDown) {\n          this.controlMouseDown = true\n          this.controlHoveredChange.unsubscribe()\n        }\n        this.video.nativeElement.muted = false\n        this.video.nativeElement.volume = e\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(volumeTouchDrag$.subscribe(e => {\n        this.video.nativeElement.volume = e\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(this.mouseTouchUp$.subscribe(() => {\n        if (this.controlMouseDown) {\n          subscribeControlHoveredChange()\n          this.controlMouseDown = false\n          this.showControlProbablyChanged$.next(0)\n          this.changeDetectorRef.detectChanges()\n        }\n      }))\n    })\n    const speedMouseTouchDown$ = onMouseTouchDown$(\n      this.speedBar.nativeElement,\n      (moveEvent, rect) => (moveEvent.clientX - rect.left),\n      (rect) => (rect.width)\n    )\n    const speedTouchDrag$ = onMouseTouchDrag$(\n      this.speedBar.nativeElement,\n      (moveEvent, rect) => (moveEvent.clientX - rect.left),\n      (rect) => (rect.width)\n    )\n    this.zone.runOutsideAngular(() => {\n      this.mouseSubscriptions.push(speedMouseTouchDown$.subscribe(e => {\n        if (!this.controlMouseDown) {\n          this.controlMouseDown = true\n          this.controlHoveredChange.unsubscribe()\n        }\n        this.video.nativeElement.playbackRate = UshioComponent.mapProgressToSpeed(e)\n        this.changeDetectorRef.detectChanges()\n      }))\n      this.mouseSubscriptions.push(speedTouchDrag$.subscribe(e => {\n        this.video.nativeElement.playbackRate = UshioComponent.mapProgressToSpeed(e)\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n  }\n\n  private subscribeTimeUpdate () {\n    this.zone.runOutsideAngular(() => {\n      this.timeUpdate = fromEvent(this.video.nativeElement, 'timeupdate')\n        .subscribe(() => {\n          this.mCurrentTime = this.video.nativeElement.currentTime\n          this.currentTimeChange.emit(this.mCurrentTime)\n          this.updateFlyingSubtitles(this.mCurrentTime)\n          this.changeDetectorRef.detectChanges()\n        })\n    })\n  }\n\n  ngAfterViewInit () {\n    this.viewInit = true\n    this.touchStart$.subscribe(() => {\n      this.interactMode = 'mobile'\n    })\n    const desktopShowControlStateChange$ = this.mouseMove$.pipe(\n      filter(() => (this.interactMode === 'desktop')),\n      map((e: MouseEvent) => {\n        const rect = this.video.nativeElement.getBoundingClientRect()\n        return {\n          showControl: e.clientX > rect.left &&\n            e.clientX < rect.right &&\n            e.clientY > rect.top &&\n            e.clientY < rect.bottom,\n          delaySwitch: e.clientY < rect.bottom - 46\n        }\n      })\n    )\n    const showControlStateChange$ = merge(\n      desktopShowControlStateChange$,\n      this.mobileShowControlStateChange$\n    ).pipe(\n      switchMap(e => {\n        return e.showControl\n          ? merge(\n            of({\n              showControl: true,\n              noCursor: false\n            }),\n            e.delaySwitch ? timer(\n              this.interactMode === 'desktop' ? 750 : 5000\n            ).pipe(\n              mapTo({\n                showControl: false,\n                noCursor: true\n              })\n            ) : NEVER\n          )\n          : of({\n            showControl: false,\n            noCursor: false\n          })\n      }),\n      distinctUntilChanged((a, b) => (\n        a.showControl === b.showControl && a.noCursor === b.noCursor\n      ))\n    )\n    this.zone.runOutsideAngular(() => {\n      this.subscriptions.push(showControlStateChange$.subscribe(state => {\n        this.mShowControl = state.showControl\n        this.showControlProbablyChanged$.next(0)\n        this.mNoCursor = state.noCursor\n        this.changeDetectorRef.detectChanges()\n      }))\n    })\n    if (this.mPaused) this.video.nativeElement.pause()\n    else this.video.nativeElement.play()\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'pause')\n      .subscribe(() => {\n        this.mPaused = true\n        this.pausedChange.emit(true)\n      }))\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'play')\n      .subscribe(() => {\n        this.mPaused = false\n        this.pausedChange.emit(false)\n      }))\n    this.subscribeTimeUpdate()\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'waiting')\n      .subscribe(() => {\n        this.waiting = true\n        this.waitingChange.emit(this.waiting)\n      }))\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'playing')\n      .subscribe(() => {\n        this.waiting = false\n        this.waitingChange.emit(this.waiting)\n      }))\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'progress')\n      .subscribe(() => {\n        this.bufferedTime = ((timeRanges, currentTime) => {\n          const length = timeRanges.length\n          for (let i = 0; i < length; i++) {\n            if (timeRanges.end(i) <= currentTime) {\n              continue\n            }\n            if (timeRanges.start(i) <= currentTime) {\n              return timeRanges.end(i)\n            }\n            return currentTime\n          }\n          return currentTime\n        })(this.video.nativeElement.buffered, this.video.nativeElement.currentTime)\n      }))\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'loadedmetadata')\n      .subscribe(() => {\n        this.duration = this.video.nativeElement.duration\n        this.durationChange.emit(this.duration)\n      }))\n    this.video.nativeElement.volume = this.mVolume\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'volumechange')\n      .subscribe(() => {\n        this.mVolume = this.video.nativeElement.volume\n        this.volumeChange.emit(this.mVolume)\n      }))\n    this.video.nativeElement.playbackRate = this.mPlaybackRate\n    this.subscriptions.push(fromEvent(this.video.nativeElement, 'ratechange')\n      .subscribe(() => {\n        this.mPlaybackRate = this.video.nativeElement.playbackRate\n        this.playbackRateChange.emit(this.mPlaybackRate)\n      }))\n    this.subscriptions.push(fromEvent(this.element.nativeElement, 'contextmenu')\n      .subscribe((e: MouseEvent) => {\n        e.preventDefault()\n        const outer = this.element.nativeElement.getBoundingClientRect()\n        const panel = this.contextMenu.nativeElement.getBoundingClientRect()\n        if (e.clientX + panel.width + 20 > outer.right) {\n          if (e.clientY + panel.height + 20 > outer.bottom) {\n            this.mContextMenuPosition = `right: ${outer.right - e.clientX}px; bottom: ${outer.bottom - e.clientY}px`\n          } else {\n            this.mContextMenuPosition = `right: ${outer.right - e.clientX}px; top: ${e.clientY - outer.top}px`\n          }\n        } else {\n          if (e.clientY + panel.height + 20 > outer.bottom) {\n            this.mContextMenuPosition = `left: ${e.clientX - outer.left}px; bottom: ${outer.bottom - e.clientY}px`\n          } else {\n            this.mContextMenuPosition = `left: ${e.clientX - outer.left}px; top: ${e.clientY - outer.top}px`\n          }\n        }\n        this.contextMenuState = 'root'\n        this.showContextMenu = true\n      }))\n    this.zone.runOutsideAngular(() => {\n      this.langContextMenuOption.nativeElement.addEventListener('click', this.showLangMenu, true)\n      this.element.nativeElement.addEventListener('click', this.onComponentClicked, true)\n      document.addEventListener('click', this.onDocumentClicked, true)\n    })\n    this.zone.runOutsideAngular(() => {\n      this.showControlChange$.subscribe(showControl => {\n        if (showControl) this.onControlShown()\n        else this.onControlDismiss()\n        this.showControlChange.emit(showControl)\n      })\n    })\n  }\n\n  // https://github.com/angular/angular/issues/17404\n  ngOnDestroy () {\n    clearTimeout(this.setAllControlPanelsPositionTimeout)\n    this.onUnfocused()\n    this.onControlDismiss()\n    if (this.timeUpdate) {\n      this.timeUpdate.unsubscribe()\n      this.timeUpdate = null\n    }\n    this.subscriptions.forEach(sub => sub.unsubscribe())\n    this.subscriptions = []\n    this.langContextMenuOption.nativeElement.removeEventListener('click', this.showLangMenu, true)\n    this.element.nativeElement.removeEventListener('click', this.onComponentClicked, true)\n    document.removeEventListener('click', this.onDocumentClicked, true)\n  }\n\n  private updateSources () {\n    if (this.mSources.length === 0) {\n      this.sources = [{\n        shortName: 'Default',\n        name: 'Default',\n        default: true,\n        sources: [{ src: this.mSrc, type: undefined }]\n      }]\n    } else {\n      const sm = {}\n      this.mSources.forEach(source => {\n        if (!source.shortname) {\n          source.shortname = 'Untitled'\n        }\n        if (!sm[source.shortname]) {\n          sm[source.shortname] = {\n            shortName: source.shortname,\n            name: source.name || 'Untitled',\n            sources: []\n          }\n        }\n        sm[source.shortname].sources.push(source)\n        if (source.default !== undefined && source.default !== null) {\n          sm[source.shortname].default = true\n        }\n      })\n      this.sources = Object.values(sm)\n    }\n    const indexOfDefault = this.sources.findIndex(s => s.default)\n    this.playingSource = indexOfDefault >= 0 ? indexOfDefault : 0\n    if (this.viewInit) this.video.nativeElement.load()\n  }\n\n  private async updateSubtitles () {\n    const parsedSubtitles = []\n    for (const sub of this.mSubtitles) {\n      let text = ''\n      if (sub.value) text = sub.value\n      else if (sub.src) {\n        const resp = await fetch(sub.src)\n        text = await resp.text()\n      }\n      const parsed = {\n        name: sub.name || 'Untitled',\n        class: sub.class || '',\n        parsedSubtitles: undefined,\n        enabled: sub.default !== undefined && sub.default !== null\n          || sub.srclang === this.service.i18n.language\n      }\n      sub.type = sub.type || ''\n      sub.type = sub.type.toLowerCase()\n      if (sub.type !== 'text/vtt' && sub.type !== 'application/x-subrip') {\n        console.warn('Unknown MIME type of subtitles, trying to infer subtitle format. Supported type: text/vtt, application/x-subrip.')\n      }\n      try {\n        parsed.parsedSubtitles = this.service.parseSubtitles(text)\n      } catch (e) {\n        console.error(e)\n      }\n      parsedSubtitles.push(parsed)\n    }\n    this.subtitles = parsedSubtitles\n    this.updateFlyingSubtitles()\n  }\n\n  private updateFlyingSubtitles (currentTime?) {\n    if (currentTime === undefined) {\n      currentTime = this.video.nativeElement.currentTime\n    }\n    currentTime *= 1000\n    const flyingSubtitles = []\n    this.enabledSubtitles.forEach(subtitles => {\n      if (!subtitles.parsedSubtitles) return\n      const flyingSubtitlesTrack = []\n      subtitles.parsedSubtitles.forEach(subtitle => {\n        if (currentTime > subtitle.startTime && currentTime < subtitle.endTime) {\n          flyingSubtitlesTrack.push({\n            ...subtitle,\n            texts: subtitle.texts.map(text => this.sanitization.bypassSecurityTrustHtml(text))\n          })\n        }\n      })\n      if (flyingSubtitlesTrack.length) {\n        flyingSubtitles.push({\n          name: subtitles.name,\n          class: subtitles.class,\n          parsedSubtitles: flyingSubtitlesTrack\n        })\n      }\n    })\n    this.flyingSubtitles = flyingSubtitles\n  }\n\n  private setAllControlPanelsPosition () {\n    this.zone.runOutsideAngular(() => {\n      this.setAllControlPanelsPositionTimeout = setTimeout(() => {\n        [{\n          btn: this.settingsBtn,\n          panel: this.settingsPanel,\n          name: 'settings'\n        }, {\n          btn: this.sourceBtn,\n          panel: this.sourcePanel,\n          name: 'source'\n        }, {\n          btn: this.subtitlesBtn,\n          panel: this.subtitlesPanel,\n          name: 'subtitles'\n        }, {\n          btn: this.loopBtn,\n          panel: this.loopPanel,\n          name: 'loop'\n        }, {\n          btn: this.fullScreenBtn,\n          panel: this.fullScreenPanel,\n          name: 'fullscreen'\n        }].forEach(item => this.setPanelPosition(item.btn, item.panel, item.name))\n        this.changeDetectorRef.detectChanges()\n      }, 0)\n    })\n  }\n\n  private setPanelPosition (btn, panel, name) {\n    if (!this.element || !panel || !btn) return\n    const outerRect = this.element.nativeElement.getBoundingClientRect()\n    const panelRect = panel.nativeElement.getBoundingClientRect()\n    const btnRect = btn.nativeElement.getBoundingClientRect()\n    if (panelRect.width / 2 - outerRect.right + btnRect.right > 0) {\n      this.panelTranslations[name] = panelRect.width / 2 - outerRect.right + btnRect.right\n    } else {\n      this.panelTranslations[name] = 0\n    }\n  }\n\n  onSlotChange (e) {\n    this.subtitlesSlotUpdate$.next(\n      e.target.assignedNodes().filter(node => node.nodeName === 'USHIO-SUBTITLES')\n    )\n    this.sourcesSlotUpdate$.next(\n      e.target.assignedNodes().filter(node => node.nodeName === 'USHIO-SOURCE')\n    )\n    this.mInjectedStyles = e.target.assignedNodes()\n      .filter(node => node.nodeName === 'STYLE').map(node => node.innerHTML)\n  }\n\n  onVideoMaskClicked () {\n    if (this.interactMode === 'desktop') {\n      this.togglePlay()\n    } else {\n      this.mobileShowControlStateChange$.next({\n        showControl: !this.mShowControl,\n        delaySwitch: true\n      })\n    }\n  }\n\n  onSelectSource (i) {\n    if (i === this.playingSource) return\n    const currentTime = this.mCurrentTime\n    const paused = this.mPaused\n    this.playingSource = i\n    this.video.nativeElement.load()\n    this.video.nativeElement.currentTime = currentTime\n    if (!paused) this.video.nativeElement.play()\n  }\n\n  onCheckSubtitles (i) {\n    this.subtitles[i].enabled = !this.subtitles[i].enabled\n    this.updateFlyingSubtitles()\n    this.changeDetectorRef.detectChanges()\n  }\n\n  togglePlay () {\n    if (this.video.nativeElement.paused) this.video.nativeElement.play()\n    else this.video.nativeElement.pause()\n  }\n\n  toggleMute () {\n    if (this.interactMode === 'desktop') {\n      this.video.nativeElement.muted = !(this.video.nativeElement.muted || this.video.nativeElement.volume === 0)\n      this.mutedChange.emit(this.video.nativeElement.muted)\n    } else if (this.video.nativeElement.muted) {\n      this.video.nativeElement.muted = false\n      this.mutedChange.emit(false)\n    }\n    if (!this.video.nativeElement.muted && this.video.nativeElement.volume === 0) {\n      this.video.nativeElement.volume = Math.random()\n    }\n  }\n\n  toggleLoop () {\n    this.video.nativeElement.loop = !this.video.nativeElement.loop\n    this.loopChange.emit(this.video.nativeElement.loop)\n  }\n\n  toggleFullscreen () {\n    if (!this.isFullScreen) {\n      this.element.nativeElement.requestFullscreen()\n    } else {\n      document.exitFullscreen()\n    }\n  }\n\n  showLangMenu () {\n    this.contextMenuState = 'lang'\n    this.showContextMenu = true\n    this.changeDetectorRef.detectChanges()\n  }\n\n  onComponentClicked () {\n    this.focus = true\n    if (this.keySubscriptions.length === 0) {\n      this.onFocused()\n    }\n  }\n\n  onDocumentClicked () {\n    this.focus = false\n    if (this.showContextMenu) {\n      this.showContextMenu = false\n      this.changeDetectorRef.detectChanges()\n    }\n  }\n\n  setLanguage (code) {\n    this.service.i18n.setLanguage(code)\n  }\n\n  toggleShowStatisticInfoPanel () {\n    this.showStatisticInfoPanel = !this.showStatisticInfoPanel\n    if (this.showStatisticInfoPanel) {\n      this.zone.runOutsideAngular(() => {\n        const animationFrame$ = of(null, animationFrameScheduler).pipe(repeat())\n        this.animationFrame = animationFrame$.subscribe(() => {\n          if (!this.fpsStart) this.fpsStart = +new Date()\n          this.fpsIndex++\n          const fpsCurrent = +new Date()\n          if (fpsCurrent - this.fpsStart > 1000) {\n            this.fps = ((this.fpsIndex / (fpsCurrent - this.fpsStart)) * 1000).toFixed(2)\n            this.fpsStart = +new Date()\n            this.fpsIndex = 0\n            this.changeDetectorRef.detectChanges()\n          }\n        })\n      })\n    } else {\n      this.animationFrame.unsubscribe()\n    }\n  }\n\n}\n","import { CommonModule } from '@angular/common'\nimport { NgModule } from '@angular/core'\n\nimport { UshioComponent, UshioSource, UshioSubtitles } from './ushio.component'\n\n@NgModule({\n  declarations: [\n    UshioComponent,\n    UshioSource,\n    UshioSubtitles\n  ],\n  imports: [\n    CommonModule\n  ],\n  exports: [\n    UshioComponent,\n    UshioSource,\n    UshioSubtitles\n  ]\n})\nexport class UshioModule { }\n"]}